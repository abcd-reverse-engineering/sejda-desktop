$(function(){function t(){var t=$("#split-part1");try{t.resizable("destroy")}catch(t){}var e=n.hasClass("horizontal");e?t.css({width:"100%",height:"50%"}):t.css({height:"100%",width:"50%"});var a=$(".task-form");a.find("input[name=ratio]").val(1),a.find("input[name=mode]").val(e?"horizontal":"vertical"),t.resizable({handles:e?"s":"e",containment:"parent",resize:function(){var i;if(e){var r=parseFloat(t.height()),o=parseFloat(n.height())-r;i=r/o}else{var l=parseFloat(t.width()),d=parseFloat(n.width())-l;i=l/d}a.find("input[name=ratio]").val(i)}})}function e(t,e,a){t.getPage(e).then(function(t){var e=t.getViewport({scale:1});a(null,e)})}function a(t,e,a){t.getPage(e).then(function(t){var e=t.getViewport({scale:1}),i=Math.min(1100,.7*screen.width),n=i/e.width,o=t.getViewport({scale:n}),d=r.find("canvas");d.attr("data-scale",n);var h=d.get(0),c=h.getContext("2d");h.height=o.height,h.width=o.width;var s={canvasContext:c,viewport:o};c.clearRect(0,0,h.width,h.height);var g=t.render(s);return g.promise.then(function(){var e=$("#blended-canvas").get(0),i=e.getContext("2d");l&&(l=!1,e.height=h.height,e.width=h.width,i.beginPath(),i.rect(0,0,e.width,e.height),i.fillStyle="white",i.fill()),c.blendOnto(i,"multiply"),a(null,h.toDataURL(),n),t.cleanup(),t=null},function(e){a(e),t.cleanup(),t=null})})}function i(i){PdfFiles.getDocument(i,function(i){function l(t){var a=!1;return i.numPages<2?t(a):void e(i,1,function(n,r){e(i,2,function(e,i){var n=r.width>r.height,o=i.width>i.height;return n!=o&&(a=!0),t(a)})})}function d(e,l,c){if(h+=1,h<=i.numPages&&h<o)a(i,h,d);else{var s=r.find("img.jsplit"),g=r.find("canvas");s.on("load",function(){var e=s.width(),a=s.height();s.attr("data-original-width",e).attr("data-original-height",a).attr("data-original-scale",g.attr("data-scale")).attr("data-scale",g.attr("data-scale")),g.remove(),n.width(e).height(a),a>e?n.addClass("horizontal"):n.addClass("vertical"),t(),$("#page-area-loader").hide()}),s.attr("src",$("#blended-canvas").get(0).toDataURL()),$("#blended-canvas").remove(),$("#page-area-selector-content").show(),$(".doc-loading").hide(),i.destroy()}}$(".doc-loading").hide();var h=0;l(function(t){t&&(h+=1,$("#excludedPages").val("1")),$("#page-area-selector-wrap").show(),d()})})}var n=$("#jsplit-holder"),r=$("#page-area-selector"),o=10;$(".split-mode-btn").click(function(){var e=$(this).attr("data-mode");n.removeClass("horizontal vertical").addClass(e),t()});var l=!0;$(document).on("filesSelected",function(t,e){i(e.files[0])}),$(document).on("change","[name=autoDetectExcludedPages]",function(t){var e=t.target.checked,a=$("#excludedPages").parents(".row");e?a.hide():a.show()})});