function storageWrapper(e){function t(){if(!u)throw new Error("Storage not supported:"+e)}function n(){try{t(),e.clear()}catch(e){c={}}}function o(n){try{return t(),e.getItem(n)}catch(e){return c.hasOwnProperty(n)?c[n]:null}}function a(n){try{return t(),e.key(n)}catch(e){return Object.keys(c)[n]||null}}function i(n){try{t(),e.removeItem(n)}catch(e){delete c[n]}}function r(n,o){try{t(),e.setItem(n,o)}catch(e){c[n]=o}}function s(){try{return e.length}catch(e){return-1}}var c={},u=!0;try{const l="__some_random_key_you_are_not_going_to_use__";e.setItem(l,l),e.removeItem(l),u=!0}catch(t){console.error("Storage",e,"not supported",t),u=!1}return{getItem:o,setItem:r,removeItem:i,clear:n,key:a,supported:u,length:s}}function escapeRegExp(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function stripQuotes(e){return'"'==e.charAt(0)&&'"'==e.charAt(e.length-1)?e.substring(1,e.length-1):"'"==e.charAt(0)&&"'"==e.charAt(e.length-1)?e.substring(1,e.length-1):e}function parseFilename(e){if(!e)return["","",""];const t=e.lastIndexOf(".");if(t>=0){const n=e.substr(t+1).toLowerCase(),o=e.substr(0,t);return[o,n,"."+n]}return[e,"",""]}function uuidv4(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,n="x"==e?t:3&t|8;return n.toString(16)})}function randomString(e){e=e||10;const t="123456789ABCDEFGHJKMNPQRSTUVWXYZ";return Array(e+1).join("x").replace(/x/g,function(){return t[Math.trunc(32*Math.random())]})}function captionForUri(e){return e.startsWith("/")&&(e=e.substring(1)),$megaMenu.find('a[href="'+e+'"]').first().find(".caption").text()||e}function showAlert(e,t,n){t=t||"danger",n=n!==!1;var o=e.hashCode();if(!($("#alert"+o).length>0)){var a=$('<div class="top-alert alert alert-dismissible" role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button></div>');a.attr("id","alert"+o),a.addClass("alert-"+t);var i=$("<span></span>").textBr(e);a.append(i),$("body").prepend(a),a.fadeIn(200),n?a.click(function(){a.alert("close")}):(a.removeClass("alert-dismissable"),a.find(".close").remove()),a.css("z-index",zIndexCounter),zIndexCounter+=1}}function showModalAlert(e){const t=e.title||s_i18n("Error");var n=e.msg.trim();n.endsWith(".")||(n+=".");const o=e.closeCallback||function(){},a=$("#genericErrorModal");a.find(".modal-title").text(t),a.find(".modal-body").textBr(n),a.off("hidden.bs.modal"),a.on("hidden.bs.modal",o),a.modal("show")}function isInt(e){var t=parseFloat(e);return!isNaN(t)&&parseInt(Number(t))==t&&!isNaN(parseInt(t,10))}function isStrictPositiveNumber(e){return isNum(e)&&e>0}function naturalSort(e,t){var n,o,a=/(^([+\-]?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?(?=\D|\s|$))|^0x[\da-fA-F]+$|\d+)/g,i=/^\s+|\s+$/g,r=/\s+/g,s=/(^([\w ]+,?[\w ]+)?[\w ]+,?[\w ]+\d+:\d+(:\d+)?[\w ]?|^\d{1,4}[\/\-]\d{1,4}[\/\-]\d{1,4}|^\w+, \w+ \d+, \d{4})/,c=/^0x[0-9a-f]+$/i,u=/^0/,l=function(e){return(naturalSort.insensitive&&(""+e).toLowerCase()||""+e).replace(i,"")},d=l(e),f=l(t),p=d.replace(a,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),g=f.replace(a,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),m=parseInt(d.match(c),16)||1!==p.length&&Date.parse(d),h=parseInt(f.match(c),16)||m&&f.match(s)&&Date.parse(f)||null,w=function(e,t){return(!e.match(u)||1==t)&&parseFloat(e)||e.replace(r," ").replace(i,"")||0};if(h){if(m<h)return-1;if(m>h)return 1}for(var v=0,$=p.length,b=g.length,F=Math.max($,b);v<F;v++){if(n=w(p[v]||"",$),o=w(g[v]||"",b),isNaN(n)!==isNaN(o))return isNaN(n)?1:-1;if(/[^\x00-\x80]/.test(n+o)&&n.localeCompare){var C=n.localeCompare(o),y=Math.abs(C);if(0!==C&&0!==y)return C/y}if(n<o)return-1;if(n>o)return 1}}function unicodeEscape(e){return e.replace(/[\s\S]/g,function(e){var t=e.charCodeAt().toString(16),n=t.length>2;return"\\"+(n?"u":"x")+("0000"+t).slice(n?-4:-2)})}function resizeImage(e,t,n){var o=e.get(0).naturalWidth,a=e.get(0).naturalHeight;if(o<=t||a<=n)return e.attr("src");var i=document.getElementById("image-resize-canvas");i.width=t,i.height=n;var r=i.getContext("2d");return r.drawImage(e.get(0),0,0,t,n),i.toDataURL()}function debounce(e,t,n){var o;return function(){var a=this,i=arguments,r=function(){o=null,n||e.apply(a,i)},s=n&&!o;clearTimeout(o),o=setTimeout(r,t),s&&e.apply(a,i)}}function cleanUnicodeControlCharsAndSpaces(e){return"undefined"==typeof e?"":e.replace(/[\u0009\u00A0\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000]/g," ").replace(/[\u200B\u2028\u2029]/g,"").replace(/[\u200A\u000A\u000B\u000C\u000D]/g,"")}function cleanUnicodeControlCharsAndSpacesKeepNewlines(e){return"undefined"==typeof e?"":e.replace(/[\u0009\u00A0\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000]/g," ").replace(/[\u200B\u2028\u2029]/g,"")}function appendToUrl(e,t){var n=_.pairs(t).map(function(e){return e[0]+"="+encodeURIComponent(e[1])}).join("&");return e.indexOf("?")<0?e+"?_=_&"+n:e+"&"+n}function isPro(){return"true"==$("body").attr("data-pro-user")}function canMultiple(){var e=$("#task-content").attr("data-multiple-files");return"true"==e||"pro"==e&&isPro()}function canMaybeMultiple(){return"false"!=$("#task-content").attr("data-multiple-files")}function isIe(){return Sejda.Browsers.isIe}function isFirefox(){return Sejda.Browsers.isFirefox}function tryJSONparse(e){try{return JSON.parse(e)}catch(e){return}}function acceptsFileType(e){return filetypes.indexOf(e)>=0}function changeCaption(e,t){var n=e.text().replace("PDF",t);e.text(n)}function task(){return $("#task-content").attr("data-task")}function loadScript(e,t,n){var o=document.createElement("script");o.type="text/javascript",o.onload=t,n&&(o.onerror=n),o.src=e;var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(o,a)}function loadScripts(e){if(0!==e.length){var t=e[0],n=e.slice(1);loadScript(t,function(){loaded++,loadScripts(n)},function(){loadScripts(n)})}else if(0===loaded){var o=window.location.pathname.split("/").slice(-1)[0].dropRight(4);""!==o&&"compress-pdf"!==o&&"deskew-pdf"!==o&&"index"!==o&&"unlock-pdf"!==o&&loadScript("public/js/pages/"+o+".min.js")}}!function(e){var t=e.console||(e.console={});t.log||(t.log=function(){})}(this),Sejda={},Sejda.Desktop={},PDFJS=window["pdfjs-dist/build/pdf"],Sejda.pageMenuActions=[];var Analytics=function(){const e=[];return{trackNoPushEvent:function(t,n,o,a){e.push([t,n,o,a].join(" "))},trackEvent:function(t,n,o,a){e.push([t,n,o,a].join(" "))},events:function(){return e}}}();Sejda.EventManager=function(){const e={};var t={};return e.on=function(e,n){return t[e]||(t[e]=[]),t[e].push(n),{eventName:e,handlerIndex:t[e].length-1}},e.off=function(e){t[e.eventName]&&t[e.eventName].splice(e.handlerIndex,1)},e.removeAllHandlers=function(e){e?delete t[e]:t={}},e.trigger=function(e,n){t[e]&&t[e].forEach(function(e){e(n)})},e.getHandlers=function(e){return t[e]||[]},e},window.Raven=Sejda.Raven=function(){function e(){$(document).trigger("reportJsErrorPrompt")}function t(e){return function(){const t=Array.prototype.slice.call(arguments),n=t.join(" ");a.size<100&&a.add(n);try{o.trigger("logs",n)}catch(e){}e.apply(console,arguments)}}const n={};n.captureException=function(e){try{Analytics.trackNoPushEvent("capturedException",e.message,e.stack||e.stacktrace),console.error(e)}catch(e){}},n.captureMessage=function(e){Analytics.trackNoPushEvent("capturedMessage",e),console.error(e)},window.addEventListener("error",function(t){const n=t.error||{};try{console.error(t),console.error(n),Analytics.trackNoPushEvent("window.error",JSON.stringify(t,null,2),n.message,n.stack||n.stacktrace),e()}catch(e){}}),window.addEventListener("unhandledrejection",function(t){const n=t.error||{};try{console.error(t),console.error(n),Analytics.trackNoPushEvent("window.unhandledrejection",JSON.stringify(t,null,2),n.message,n.stack||n.stacktrace),e()}catch(e){}});const o=Sejda.EventManager();n.addEventListener=function(e,t){o.on(e,t)};var a=new Set;return n.consoleLogs=function(){return Array.from(a)},console.olog=console.log,function(){var e=console.log;console.log=t(e)}(),function(){var e=console.info;console.info=t(e)}(),function(){var e=console.warn;console.warn=t(e)}(),function(){var e=console.error;console.error=t(e)}(),n}();var tooltipOpts={placement:"top",delay:{show:300,hide:0},container:"body",trigger:"hover"},tooltipBottomOpts=$.extend({},tooltipOpts,{placement:"bottom"}),tooltipDelayedOpts=$.extend({},tooltipOpts,{delay:{show:800,hide:0}});Sejda.LocalStorage=storageWrapper(window.localStorage),Sejda.SessionStorage=storageWrapper(window.sessionStorage),String.prototype.endsWith||(String.prototype.endsWith=function(e,t){return(void 0===t||t>this.length)&&(t=this.length),this.substring(t-e.length,t)===e}),String.prototype.countOccurences||(String.prototype.countOccurences=function(e){return this.split(e).length-1}),String.prototype.startsWith=String.prototype.startsWith||function(e){return 0==this.indexOf(e)},String.prototype.contains=String.prototype.contains||function(e){return this.indexOf(e)>=0},String.prototype.replaceAll=function(e,t){return this.replace(new RegExp(e,"g"),t)},String.prototype.replaceAllCaseInsensitive=function(e,t){return this.replace(new RegExp(e,"gi"),t)},String.prototype.replaceAllEscaped=function(e,t){return this.replace(new RegExp(escapeRegExp(e),"g"),t)},String.prototype.replaceAllEscapedCaseInsensitive=function(e,t){return this.replace(new RegExp(escapeRegExp(e),"gi"),t)},String.prototype.trimEnd=String.prototype.trimEnd?String.prototype.trimEnd:function(){if(String.prototype.trimRight)return this.trimRight();if(String.prototype.trim){var e=this.trim(),t=this.indexOf(e);return this.slice(t,this.length)}},JSON.tryParse=function(e){try{return JSON.parse(e)}catch(e){return null}},jQuery.fn.toggleDisabled=function(){$(this[0]).prop("disabled",function(e,t){return!t})},jQuery.fn.disable=function(){return $(this).attr("disabled","disabled"),this},jQuery.fn.enable=function(){return $(this).removeAttr("disabled"),this},jQuery.fn.attrOr=function(e,t){var n=$(this[0]);return n.attr(e)||t},jQuery.fn.textBr=function(e){var t=$(this[0]);const n=t.text(Sejda.Utils.sanitizeHTML(e)).text().replaceAllEscapedCaseInsensitive("\n","<br/>");return t.html(n),t},jQuery.fn.autocomplete=function(e){const t=$(this[0]),n=e.source||[],o=$("<ul></ul>").addClass("autocomplete");return n.forEach(function(e){o.append($("<li></li>").text(e))}),o.find("li").on("click",function(e){e.preventDefault(),e.stopPropagation();const n=$(e.target),a=n.text();return Number.isNaN(parseFloat(a))?t.attr("type","text"):(t.attr("type","number"),t.attr("step","1")),o.hide(),t.val(a).trigger("input"),!1}),$("body").append(o.hide()),t.on("focus",function(){const e=t.offset(),n=t.get(0).getBoundingClientRect(),a=n.height,i=n.width;o.css({position:"absolute",left:e.left+"px",top:e.top+a+6+"px"}).show();const r=o.width(),s=(i-r)/2;o.css({left:e.left+s+"px"})}),t.parents(".dropdown-menu").siblings(".dropdown-toggle").parent().on("hide.bs.dropdown",function(){o.hide()}),this},jQuery.fn.scrollHere=function(e){var t=$(this[0]);return 0==t.length?void console.error("Cannot scrollHere, element not found",t):void $("html, body").animate({scrollTop:t.offset().top+(e||0)},500)},jQuery.fn.scrollStopped=function(e){var t=this,n=$(t);n.scroll(function(o){clearTimeout(n.data("scrollTimeout")),n.data("scrollTimeout",setTimeout(e.bind(t),250,o))})},jQuery.fn.clearCanvases=function(){$(this).find("canvas").each(function(){var e=this,t=e.getContext("2d");t.clearRect(0,0,e.width,e.height)})},jQuery.fn.cloneWithCanvas=function(){function e(e,t){const n=t.getContext("2d");t.width=e.width,t.height=e.height,n.drawImage(e,0,0)}const t=$(this),n=t.clone();if(n.find("canvas").each(function(){const n=$(this),o=n.attr("id"),a=t.find("#"+o).get(0),i=this;e(a,i)}),n.is("canvas")){const o=t.get(0),a=n.get(0);e(o,a)}return n},jQuery.fn.isInViewport=function(e){"undefined"==typeof e&&(e=0);var t=this[0],n=t.getBoundingClientRect();if(0===n.top&&0===n.bottom&&0===n.left&&0===n.right)return!1;var o=$(window),a=n.bottom<0||n.right<0||n.top>o.height()+e||n.left>o.width();return!a},jQuery.fn.classes=function(e,t){var n=[];if(e=e||"",$.each(this,function(t,o){var a=o.className.split(/\s+/);for(var i in a){var r=a[i];-1===n.indexOf(r)&&0==r.index(e)&&n.push(r)}}),"function"==typeof t)for(var o in n)t(n[o]);return n},jQuery.fn.shake=function(){return this.each(function(e){for(var t=1;t<=3;t++)$(this).animate({left:-10},10).animate({left:0},50).animate({left:10},10).animate({left:0},50)}),this};const sejdaBase="https://www.sejda.com";jQuery.jsonPost=function(e,t,n){return $.ajax({url:sejdaBase+e,data:JSON.stringify(t),headers:n,method:"POST",dataType:"json",contentType:"application/json; charset=utf-8"})},jQuery.jsonGet=function(e,t){return $.ajax({url:sejdaBase+e,method:"GET",dataType:"json",contentType:"application/json; charset=utf-8"}).done(t)},jQuery.fn.hideAfter=function(e){var t=$(this[0]);setTimeout(function(){t.hide()},e)},String.prototype.hashCode=function(){var e,t,n,o=0;if(0==this.length)return o;for(e=0,n=this.length;e<n;e++)t=this.charCodeAt(e),o=(o<<5)-o+t,o|=0;return o},String.prototype.alphanumeric=function(){for(var e="",t=0;t<this.length;t++)e+=this.charCodeAt(t);return e},String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)},String.prototype.includes||(String.prototype.includes=function(e,t){return void 0===t&&(t=0),this.indexOf(e,t)!==-1});const $megaMenu=$("#megaMenu");var zIndexCounter=901,showUpgradePopupHint=function(e){showUpgradePopup(e,{disableSubmitBtn:!1})},showUpgradePopup=function(e,t){t=t||{};const n=$("#top-upgrade-section-wrap .upgrade-section"),o=n.find("#"+e+"-reason");0===o.length&&console.warn("Not found upgrade div for:",e),o.is(":visible")||(n.find(".upgrade-reason").hide(),o.show(),n.show(),t.disableSubmitBtn!==!1&&setTimeout(function(){$(".task-form").find('button[type="submit"]').attr("disabled","disabled"),n.scrollHere(-200)},500),Analytics.trackEvent("paywall",e))};String.prototype.truncateMiddle=function(e){if(this.length<=e)return this;var t="...",n=t.length,o=e-n,a=Math.ceil(o/2),i=Math.floor(o/2);return this.substr(0,a)+t+this.substr(this.length-i)},String.prototype.dropRight=function(e){return this.length<e?this:this.substr(0,this.length-e)};var isBlank=function(e){return void 0===e||0==e.trim().length},isNotBlank=function(e){return!isBlank(e)},isNum=function(e){return isNotBlank(e.trim())&&!isNaN(e.trim())},isStrictPositiveInteger=function(e){return isStrictPositiveNumber(e)&&isInt(e)},startBeforeEnd=function(e,t){return isBlank(t)||parseInt(e)<=parseInt(t)},formValidators={pages:function(e){var t=e.split(",");return _.all(t,function(e){return isStrictPositiveInteger(e)})},"page-ranges":function(e){var t=_.map(e.split(","),function(e){return e.split("-")});return _.all(t,function(e){return e.length<=2&&isStrictPositiveInteger(e[0])&&(isBlank(e[1])||isStrictPositiveInteger(e[1]))&&startBeforeEnd(e[0],e[1])})},"page-ranges-or-empty":function(e){return 0==e.trim().length||formValidators["page-ranges"](e)},"page-ranges-or-predefined":function(e){return 0==e.trim().length||"even"==e.trim()||"odd"==e.trim()||"all"==e.trim()||formValidators["page-ranges"](e)},"positive-integer":function(e){return isStrictPositiveInteger(e)},"positive-number":function(e){return isStrictPositiveNumber(e)}};Sejda.FormValidation=function(){var e={},t=$.extend({},tooltipOpts,{trigger:"manual",placement:"top"});return $("form").on("reset",function(){var e=$(this);e.find(".alert[data-error]").hide(),e.find(":input").each(function(){var e=$(this);e.removeClass("has-error"),e.tooltip("hide")})}),e.showTooltip=function(e,n){var o=$.extend({},t,{title:n,container:!1});e.tooltip(o).tooltip("show")},e.showErrorTooltip=function(t,n){e.showTooltip(t,n),t.addClass("has-error")},e.showFormErrors=function(t,n){if(0!==n.length){t.addClass("submitted"),n.forEach(function(n,o){var a=t.find('input[name="'+n.field+'"]');e.showErrorTooltip(a,n.message)});var o,a=t.find('input[name="'+n[0].field+'"]'),i=t.parents(".modal");i.length>0&&(o="#"+i.attr("id")),a.scrollHere(-100,o),Analytics.trackEvent("formInvalid",n.map(function(){return this.message}).join(", "))}},$(document).on("focus",":input",function(){var e=$(this);e.removeClass("has-error"),e.tooltip("hide")}),e}();var runFormValidators=function(e){var t=!0;return e.find("input[data-validator]:visible").each(function(e,n){var o=$(n).val(),a=$(n).attr("data-validator"),i=formValidators[a];if(!i)return void console.log("Unknown validator",a);var r=i(o);r?$(n).removeClass("has-error"):(t=!1,$(n).addClass("has-error").tooltip({html:!0,title:'<span class="danger">Value is invalid</span>',trigger:"manual",placement:"left"}).tooltip("show"))}),t};$(function(){$(document).on("input","input.has-error",function(){$(this).removeClass("has-error").tooltip("hide")})});var getQueryParameterByName=function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)"),n=t.exec(location.search);return null===n?"":decodeURIComponent(n[1].replace(/\+/g," "))};$(function(){$.ajaxSetup({cache:!1,timeout:7e3})});var menuTemplate=[{label:"Cut",accelerator:"CmdOrCtrl+X",role:"cut"},{label:"Copy",accelerator:"CmdOrCtrl+C",role:"copy"},{label:"Paste",accelerator:"CmdOrCtrl+V",role:"paste"},{label:"Select All",accelerator:"CmdOrCtrl+A",role:"selectall"}];window.addEventListener("contextmenu",function(e){e.target.closest('textarea, input, [contenteditable="true"]')&&setTimeout(function(){window.sejdaContext.electron.menu.popup(menuTemplate)},30)}),$(function(){function e(e){const n=e.attr("name");return encodeURIComponent("settings."+t+"."+n)}var t=window.location.pathname.substring(window.location.pathname.lastIndexOf("/")+1);t.endsWith(".ejs")&&(t=t.substring(0,t.lastIndexOf(".")));var n=!1;const o=$("input.remembered,select.remembered");o.each(function(){const t=$(this),o=e(t);if(null!==Sejda.LocalStorage.getItem(o)){const a=Sejda.LocalStorage.getItem(o),i=t.attr("type");if(t.is("select")){if(0===t.find('option[value="'+a+'"]').length)return void console.log("Cannot restore setting, no matching option anymore:",o,a);t.val(a)}"text"!==i&&"number"!==i||t.val(a),t.is(":checkbox")&&t.prop("checked","true"===a),"radio"===i&&t.attr("value")===a&&t.prop("checked",!0),n=!0}}),o.on("change",function(){const t=$(this),n=e(t);var o=t.val();t.is(":checkbox")&&(o=t.is(":checked")),Sejda.LocalStorage.setItem(n,o)}),$(".btn-group.remembered[data-toggle=buttons] .btn").each(function(){const t=$(this),n=t.find("input"),o=e(n);try{const a=Sejda.LocalStorage.getItem(o),i=n.attr("value");"undefined"!=typeof a&&i===a&&t.trigger("click"),t.on("click",function(){Sejda.LocalStorage.setItem(o,i)})}catch(e){}})}),naturalSort.insensitive=!0;var unicodeControlCharsRe=/[\0-\x1F\x7F-\x9F\xAD\u0378\u0379\u037F-\u0383\u038B\u038D\u03A2\u0528-\u0530\u0557\u0558\u0560\u0588\u058B-\u058E\u0590\u05C8-\u05CF\u05EB-\u05EF\u05F5-\u0605\u061C\u061D\u06DD\u070E\u070F\u074B\u074C\u07B2-\u07BF\u07FB-\u07FF\u082E\u082F\u083F\u085C\u085D\u085F-\u089F\u08A1\u08AD-\u08E3\u08FF\u0978\u0980\u0984\u098D\u098E\u0991\u0992\u09A9\u09B1\u09B3-\u09B5\u09BA\u09BB\u09C5\u09C6\u09C9\u09CA\u09CF-\u09D6\u09D8-\u09DB\u09DE\u09E4\u09E5\u09FC-\u0A00\u0A04\u0A0B-\u0A0E\u0A11\u0A12\u0A29\u0A31\u0A34\u0A37\u0A3A\u0A3B\u0A3D\u0A43-\u0A46\u0A49\u0A4A\u0A4E-\u0A50\u0A52-\u0A58\u0A5D\u0A5F-\u0A65\u0A76-\u0A80\u0A84\u0A8E\u0A92\u0AA9\u0AB1\u0AB4\u0ABA\u0ABB\u0AC6\u0ACA\u0ACE\u0ACF\u0AD1-\u0ADF\u0AE4\u0AE5\u0AF2-\u0B00\u0B04\u0B0D\u0B0E\u0B11\u0B12\u0B29\u0B31\u0B34\u0B3A\u0B3B\u0B45\u0B46\u0B49\u0B4A\u0B4E-\u0B55\u0B58-\u0B5B\u0B5E\u0B64\u0B65\u0B78-\u0B81\u0B84\u0B8B-\u0B8D\u0B91\u0B96-\u0B98\u0B9B\u0B9D\u0BA0-\u0BA2\u0BA5-\u0BA7\u0BAB-\u0BAD\u0BBA-\u0BBD\u0BC3-\u0BC5\u0BC9\u0BCE\u0BCF\u0BD1-\u0BD6\u0BD8-\u0BE5\u0BFB-\u0C00\u0C04\u0C0D\u0C11\u0C29\u0C34\u0C3A-\u0C3C\u0C45\u0C49\u0C4E-\u0C54\u0C57\u0C5A-\u0C5F\u0C64\u0C65\u0C70-\u0C77\u0C80\u0C81\u0C84\u0C8D\u0C91\u0CA9\u0CB4\u0CBA\u0CBB\u0CC5\u0CC9\u0CCE-\u0CD4\u0CD7-\u0CDD\u0CDF\u0CE4\u0CE5\u0CF0\u0CF3-\u0D01\u0D04\u0D0D\u0D11\u0D3B\u0D3C\u0D45\u0D49\u0D4F-\u0D56\u0D58-\u0D5F\u0D64\u0D65\u0D76-\u0D78\u0D80\u0D81\u0D84\u0D97-\u0D99\u0DB2\u0DBC\u0DBE\u0DBF\u0DC7-\u0DC9\u0DCB-\u0DCE\u0DD5\u0DD7\u0DE0-\u0DF1\u0DF5-\u0E00\u0E3B-\u0E3E\u0E5C-\u0E80\u0E83\u0E85\u0E86\u0E89\u0E8B\u0E8C\u0E8E-\u0E93\u0E98\u0EA0\u0EA4\u0EA6\u0EA8\u0EA9\u0EAC\u0EBA\u0EBE\u0EBF\u0EC5\u0EC7\u0ECE\u0ECF\u0EDA\u0EDB\u0EE0-\u0EFF\u0F48\u0F6D-\u0F70\u0F98\u0FBD\u0FCD\u0FDB-\u0FFF\u10C6\u10C8-\u10CC\u10CE\u10CF\u1249\u124E\u124F\u1257\u1259\u125E\u125F\u1289\u128E\u128F\u12B1\u12B6\u12B7\u12BF\u12C1\u12C6\u12C7\u12D7\u1311\u1316\u1317\u135B\u135C\u137D-\u137F\u139A-\u139F\u13F5-\u13FF\u169D-\u169F\u16F1-\u16FF\u170D\u1715-\u171F\u1737-\u173F\u1754-\u175F\u176D\u1771\u1774-\u177F\u17DE\u17DF\u17EA-\u17EF\u17FA-\u17FF\u180F\u181A-\u181F\u1878-\u187F\u18AB-\u18AF\u18F6-\u18FF\u191D-\u191F\u192C-\u192F\u193C-\u193F\u1941-\u1943\u196E\u196F\u1975-\u197F\u19AC-\u19AF\u19CA-\u19CF\u19DB-\u19DD\u1A1C\u1A1D\u1A5F\u1A7D\u1A7E\u1A8A-\u1A8F\u1A9A-\u1A9F\u1AAE-\u1AFF\u1B4C-\u1B4F\u1B7D-\u1B7F\u1BF4-\u1BFB\u1C38-\u1C3A\u1C4A-\u1C4C\u1C80-\u1CBF\u1CC8-\u1CCF\u1CF7-\u1CFF\u1DE7-\u1DFB\u1F16\u1F17\u1F1E\u1F1F\u1F46\u1F47\u1F4E\u1F4F\u1F58\u1F5A\u1F5C\u1F5E\u1F7E\u1F7F\u1FB5\u1FC5\u1FD4\u1FD5\u1FDC\u1FF0\u1FF1\u1FF5\u1FFF\u200B-\u200F\u202A-\u202E\u2060-\u206F\u2072\u2073\u208F\u209D-\u209F\u20BB-\u20CF\u20F1-\u20FF\u218A-\u218F\u23F4-\u23FF\u2427-\u243F\u244B-\u245F\u2700\u2B4D-\u2B4F\u2B5A-\u2BFF\u2C2F\u2C5F\u2CF4-\u2CF8\u2D26\u2D28-\u2D2C\u2D2E\u2D2F\u2D68-\u2D6E\u2D71-\u2D7E\u2D97-\u2D9F\u2DA7\u2DAF\u2DB7\u2DBF\u2DC7\u2DCF\u2DD7\u2DDF\u2E3C-\u2E7F\u2E9A\u2EF4-\u2EFF\u2FD6-\u2FEF\u2FFC-\u2FFF\u3040\u3097\u3098\u3100-\u3104\u312E-\u3130\u318F\u31BB-\u31BF\u31E4-\u31EF\u321F\u32FF\u4DB6-\u4DBF\u9FCD-\u9FFF\uA48D-\uA48F\uA4C7-\uA4CF\uA62C-\uA63F\uA698-\uA69E\uA6F8-\uA6FF\uA78F\uA794-\uA79F\uA7AB-\uA7F7\uA82C-\uA82F\uA83A-\uA83F\uA878-\uA87F\uA8C5-\uA8CD\uA8DA-\uA8DF\uA8FC-\uA8FF\uA954-\uA95E\uA97D-\uA97F\uA9CE\uA9DA-\uA9DD\uA9E0-\uA9FF\uAA37-\uAA3F\uAA4E\uAA4F\uAA5A\uAA5B\uAA7C-\uAA7F\uAAC3-\uAADA\uAAF7-\uAB00\uAB07\uAB08\uAB0F\uAB10\uAB17-\uAB1F\uAB27\uAB2F-\uABBF\uABEE\uABEF\uABFA-\uABFF\uD7A4-\uD7AF\uD7C7-\uD7CA\uD7FC-\uF8FF\uFA6E\uFA6F\uFADA-\uFAFF\uFB07-\uFB12\uFB18-\uFB1C\uFB37\uFB3D\uFB3F\uFB42\uFB45\uFBC2-\uFBD2\uFD40-\uFD4F\uFD90\uFD91\uFDC8-\uFDEF\uFDFE\uFDFF\uFE1A-\uFE1F\uFE27-\uFE2F\uFE53\uFE67\uFE6C-\uFE6F\uFE75\uFEFD-\uFF00\uFFBF-\uFFC1\uFFC8\uFFC9\uFFD0\uFFD1\uFFD8\uFFD9\uFFDD-\uFFDF\uFFE7\uFFEF-\uFFFB\uFFFE\uFFFF]/g;window.Sejda=window.Sejda||{},window.Sejda.TaskCommonOutput=function(){function e(e){w=e,u.set({lastUsedOutputFolder:e})}function t(t,n){n=n||function(){},f.showOpenDialog({title:"Select output folder",properties:["openDirectory","createDirectory"],defaultPath:w||b||h,buttonLabel:"Select output folder"}).then(function(o){if(o.cancelled===!0)return n();var a=o.filePaths;if(!a)return console.error("SelectedPaths is empty:",a),n();var i=a[0];if(!i)return console.error("folderName is empty:",a),n();e(i);const r=$("#outputPolicyChooserModal"),s=r.find("[name=outputFilenamePattern]");r.find(".outputFolderPath").text(i),r.find(".close").off("click").on("click",function(){return n()}),r.find(".btn-continue").off("click").on("click",function(){const e=r.find("label.active").find("input[name=outputPolicy]").val();if(!e)return console.error("Unexpected existingOutputPolicy:",e);const n=s.val()||s.attr("placeholder");t(i,!0,e,n)}),""===s.val()&&s.val(s.attr("placeholder")),r.modal("show")})}function n(t,n){n=n||function(){},f.showSaveDialog({title:"Select output file",defaultPath:r(),buttonLabel:"Select output file"}).then(function(o){if(o.cancelled===!0)return n();var a=o.filePath;if(!a)return n();var i=p||".pdf";a.toLowerCase().endsWith(i)||(a+=i),e(l.dirname(a)),t(a,!1,"overwrite")})}function o(e,o){return C?void(F?t(e,o):n(e,o)):alert("TaskCommonOutput component not initialised yet")}function a(){F=!0,$(".common-options-output-multiple-files").show()}function i(){F=!1,$(".common-options-output-multiple-files").hide()}function r(){const e=parseFilename(m);var t="",n="";""!==g&&("prefix"===v?t=g+"_":"suffix"===v&&(n="_"+g));var o=t+e[0]+n+e[2];if(p){const a=parseFilename(o)[0];o=a+p}const i=w||b||h;return l.join(i,o)}function s(e){C=!0,p=e.extension,g=e.outputFilenameAffix;const t=e.outputFilenamePattern;e.onlyFile&&i(),e.onlyDirectory&&a();var n=!1;if($(document).on("filesSelected",function(t,o){n||(n=!0,o.files.length>0&&(m=o.files[0].name),o.files.length>1&&e.onlyFile!==!0&&a())}),$(document).on("task-output-change",function(t,n){console.log(n),n.ext&&(p=e.extension),n.onlyFileOutputAccepted&&i(),n.onlyDirectoryOutputAccepted&&a()}),t)$("input[type=text][name=outputFilenamePattern]").val(t).attr("placeholder",t);else{var o="",r="";""!==g&&("prefix"===v?o=g+"_":"suffix"===v&&(r="_"+g));const s=o+"[BASENAME]"+r,c=g+"_[BASENAME]";$("input[type=text][name=outputFilenamePattern]").val(s).attr("placeholder",c)}}function c(e){p=e}const u=window.sejdaContext.general.prefs,l=window.sejdaContext.node.path,d=window.sejdaContext.electron.app,f=window.sejdaContext.electron.dialog;var p,g,m,h=u.get("lastUsedOutputFolder")||d.getPath("desktop"),w=null;const v=u.get("outputFilenameAffixOpts")||"prefix";var b,F=!1;$(document).on("fileUploadDone",function(e,t){if(!b){const n=t.path;b=l.dirname(n);try{const o=window.sejdaContext.node.fse.isTemp(n),a=n.endsWith("public/assets/new_document.pdf")||n.endsWith("public\\assets\\new_document.pdf");n&&(a||o)&&(b=void 0)}catch(e){console.error(e)}}});var C=!1;return{init:s,switchOutputToDirectory:a,switchOutputToFile:i,switchOutputFileExtension:c,promptForOutputLocation:o}}(),window.Sejda.Toasts=function(){function e(e){const t='<div class="toast-title">'+e.title+"</div>"+e.message,n=e.onClose||function(){},o=$('<div class="toast-msg"><button type="button" class="close" aria-label="Close"><span aria-hidden="true">&times;</span></button></div>');o.find(".close").click(n),o.append(t);const a=e.kind||"";o.addClass("toast-kind-"+a),$("#toast-msg-box").append(o),o.hide().fadeIn(300)}return $(document).on("click",".toast-msg .close",function(){$(this).parents(".toast-msg").remove()}),{showMessage:e}}();var SejdaException=function(){function e(e,t){this.name=e,this.message=t}return e.prototype=new Error,e.constructor=e,e}();Sejda.GlobalHints=function(){var e,t=$("#global-help-hint"),n={};return n.hideGlobalHint=function(){t.hide(),clearTimeout(e)},t.click(function(){n.hideGlobalHint()}),n.showLongHelpHint=function(e){n.showHelpHint(e,15)},n.showStickyHelpHint=function(e){n.showHelpHint(e,-1)},n.showHelpHint=function(n,o){n&&(o=o||5,clearTimeout(e),t.html(n).fadeIn(500),o>0&&(e=setTimeout(function(){t.hide()},1e3*o)))},n.showLongHelpHint_i18n=function(e){return n.showLongHelpHint(s_i18n(e))},n.showStickyHelpHint_i18n=function(e){return n.showStickyHelpHint(s_i18n(e))},n.showHelpHint_i18n=function(e,t){return n.showHelpHint(s_i18n(e),t)},n}(),window.sejdaContext.general.webContents.on("main.log",function(e){console.log(e)}),window.sejdaContext.general.webContents.on("main.appMenuClicked",function(e){const t=$('[data-app-menu-id="'+e+'"]'),n=t.get(0);n?n.click():$(document).trigger("appMenuClicked",e)}),$(function(){var e=$("#top-upgrade-section-wrap");e.find(".buy-later-btn").click(function(){e.hide()})}),$(function(){$(".caption-mac,.caption-windows,.caption-linux").hide();var e="windows",t=window.sejdaContext.node.process.platform();"darwin"===t?e="mac":"linux"===t&&(e="linux"),$(".caption-"+e).show(),$(".hide-"+e).hide()}),$(window).load(function(){$("img.deferred[data-src],img[loading=lazy][data-src]").each(function(){var e=$(this).attr("data-src");$(this).attr("src",e).removeAttr("data-src").removeClass("deferred")}),$(".divider-shadow, .divider-shadow-small").addClass("loaded")}),$(function(){$(document).on("focus","input.tooltip-on-focus",function(){$(this).parents(".input-group").find("[data-toggle=tooltip]").tooltip("show")}),$(document).on("blur","input.tooltip-on-focus",function(){$(this).parents(".input-group").find("[data-toggle=tooltip]").tooltip("hide")})}),$(function(){function e(e,t){var n=$(e);const o=document.createElement("textarea");o.value=n.attr("data-clipboard-text"),"TEXTAREA"===e.tagName&&(o.value=e.value),o.setAttribute("readonly",""),o.style.position="absolute",o.style.left="-9999px",document.body.appendChild(o),o.select(),document.execCommand("copy"),document.body.removeChild(o),n.fadeOut(0).fadeIn(200);const a=t||n;a.tooltip({title:"Copied"}).tooltip("show"),setTimeout(function(){a.tooltip("destroy")},2e3)}$(document).on("click","[data-clipboard-text]",function(t){t.preventDefault(),e(this)}),$(document).on("click",".clipboard-btn",function(){const t=$(this);var n=$(t.attr("data-clipboard-target"));n.length>0&&e(n.get(0),t)}),navigator.appVersion.indexOf("Mac")!==-1&&($(".show-windows").hide(),$(".show-macos").show())}),Sejda.Browsers=function(){return{isIe:/Edge\/|Trident\/|MSIE /.test(window.navigator.userAgent),isFirefox:/Firefox/.test(window.navigator.userAgent),isMobile:/iPhone|iPad|iPod|Android/i.test(navigator.userAgent),isUnsupported:$("#unsupportedBrowser").length>0}}(),Sejda.Base64=function(){function e(e){var t="";e=e.replace(/\r\n/g,"\n");for(var n=0;n<e.length;n++){var o=e.charCodeAt(n);o<128?t+=String.fromCharCode(o):o>127&&o<2048?(t+=String.fromCharCode(o>>6|192),t+=String.fromCharCode(63&o|128)):(t+=String.fromCharCode(o>>12|224),t+=String.fromCharCode(o>>6&63|128),t+=String.fromCharCode(63&o|128))}return t}function t(e){var t,n,o,a,i="",r=0;for(t=n=o=0;r<e.length;)t=e.charCodeAt(r),t<128?(i+=String.fromCharCode(t),r++):t>191&&t<224?(o=e.charCodeAt(r+1),i+=String.fromCharCode((31&t)<<6|63&o),r+=2):(o=e.charCodeAt(r+1),a=e.charCodeAt(r+2),i+=String.fromCharCode((15&t)<<12|(63&o)<<6|63&a),r+=3);return i}var n={},o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";return n.encode=function(t){var n,a,i,r,s,c,u,l="",d=0;for(t=e(t);d<t.length;)n=t.charCodeAt(d++),a=t.charCodeAt(d++),i=t.charCodeAt(d++),r=n>>2,s=(3&n)<<4|a>>4,c=(15&a)<<2|i>>6,u=63&i,isNaN(a)?c=u=64:isNaN(i)&&(u=64),l=l+o.charAt(r)+o.charAt(s)+o.charAt(c)+o.charAt(u);return l},n.decode=function(e){var n,a,i,r,s,c,u,l="",d=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");d<e.length;)r=o.indexOf(e.charAt(d++)),s=o.indexOf(e.charAt(d++)),c=o.indexOf(e.charAt(d++)),u=o.indexOf(e.charAt(d++)),n=r<<2|s>>4,a=(15&s)<<4|c>>2,i=(3&c)<<6|u,l+=String.fromCharCode(n),64!==c&&(l+=String.fromCharCode(a)),64!==u&&(l+=String.fromCharCode(i));return l=t(l)},n}(),Sejda.LastUsedSettings=function(){const e={"editor.text":{size:10,color:"#000",font:"Helvetica,serif"},"editor.shape":{"border-width":2,"background-color":"rgba(0, 0, 0, 0)","border-color":"#FF0000"},"editor.line":{"stroke-width":2,"stroke-color":"#FF0000"},"editor.highlight":{"background-color":"rgb(255, 213, 0)"},"editor.formfield.text":{width:400,height:30},"editor.formfield.textarea":{width:400,height:150},"editor.formfield.checkbox":{width:30,height:30},"editor.formfield.radio":{width:30,height:30},"editor.formfield.dropdown":{width:400,height:30},"editor.formfield.signature":{width:400,height:150},"editor.draw":{color:"rgb(255, 213, 0)",size:6}};var t={};return t.checkValues=function(t,n){function o(t,o,a,i){var r=n[o];(r<a||r>i)&&(n[o]=(e[t]||{})[o])}try{switch(t){case"editor.formfield.text":case"editor.formfield.textarea":case"editor.formfield.checkbox":case"editor.formfield.radio":case"editor.formfield.dropdown":o(t,"width",10,1e3),o(t,"height",10,1e3);break;case"editor.text":o(t,"size",4,1e3)}}catch(e){}return n},t.get=function(n){var o;try{var a=Sejda.LocalStorage.getItem("lastused."+n);a&&(o=JSON.parse(a))}catch(e){Raven.captureException(e)}return t.checkValues(n,o||e[n]||{})},t.set=function(e,n,o){try{var a=t.get(e);a[n]=o,Sejda.LocalStorage.setItem("lastused."+e,JSON.stringify(a))}catch(e){Raven.captureException(e)}},t.defaults=function(t){return e[t]||{};
},t}(),Sejda.PDFJS=function(){function e(){this.name="FailedLoadingPDFJSException",this.message="Failed loading PDFJS",this.stack=(new Error).stack}var t={};t.checkMetadataForScan=function(e){return e.getMetadata().then(function(e){if(e&&e.info){var t=(e.info.Creator||"").toLowerCase(),n=(e.info.Producer||"").toLowerCase();if(t.contains("canon")||t.contains("office lens")||t.contains("scansnap")||t.contains("xerox")||n.contains("tesseract")||n.contains("paper capture")||n.contains("paperport")||n.contains("adobe scan")||n.contains("image conversion plug-in"))return Promise.resolve(!0)}return Promise.resolve(!1)}).catch(function(e){console.error(e),Raven.captureException(e)})},t.checkPageContentsForScan=function(e){function t(e,t){return e.getPage(t).then(function(e){return e.getTextContent().then(function(e){return new Promise(function(t,n){e.items&&e.items.length>0&&(e.items=_.filter(e.items,function(e){return e&&e.str&&""!==e.str.trim()}));const o=e.items.length>0;t(o)})})})}function n(){return new Promise(function(n,a){function i(){return r>o||r>e.numPages?void n(!1):void t(e,r).then(function(e){e?n(!0):(r++,i())}).catch(a)}var r=1;i()})}const o=10;return n().then(function(e){const t=!e;return Promise.resolve(t)})},t.checkIfScan=function(e){return t.checkMetadataForScan(e).then(function(n){return n?Promise.resolve(!0):t.checkPageContentsForScan(e)})};var n,o,a,i={cMapUrl:"./web/cmaps/",cMapPacked:!0,disableStream:!0,disableAutoFetch:!0,enableXfa:!1,useWorkerFetch:!0,isEvalSupported:!1,standardFontDataUrl:"./web/standard_fonts/"};return t.globalBuildVersion=function(){return a},e.prototype=new Error,t.load=function(){return o=o||new Promise(function(t,o){return n?t(n):void loadScript("./public/js/pdfjs/pdf.min.js",function(){n=window["pdfjs-dist/build/pdf"],n.GlobalWorkerOptions.workerSrc="./public/js/pdfjs/pdf.worker.min.js",n.GlobalGetDocumentOptions=i,a=n.pdfjsBuild,t(n)},function(){var t=new e;console.error(t.message),Analytics.trackEvent("pdfjs","failed_loading"),o(t)})})},t.setMaxImageSize=function(e){n?n.GlobalGetDocumentOptions.maxImageSize=e:i.maxImageSize=e},t}(),Sejda.Utils=function(){function e(e){return e.replaceAll(o," ")}function t(e){return e.endsWith("@gmail.om")||e.endsWith("@gamil.com")||e.endsWith("@gmai.com")||e.endsWith("@gmail.cm")||e.endsWith("@gmail.comz")||e.endsWith("\\")||e.endsWith("@outlok.com")||e.endsWith(".cm")||e.endsWith("@yaho.com")||e.endsWith("@gmal.com")||e.endsWith("@yaoo.com")||e.endsWith(".conm")||e.endsWith(".comn")||e.endsWith(".con")||e.endsWith(".coon")||e.endsWith(".coom")||e.endsWith(".coim")||e.endsWith(".ccom")||e.endsWith(".ccon")||e.endsWith(".comm")||e.endsWith(".neet")||e.endsWith(".c0m")||e.endsWith(".cdom")||e.endsWith(".comq")||e.endsWith(".ocm")||e.endsWith(".colm")}var n={},o=new RegExp("[\t\n\v\f\r   ᠎           \u2028\u2029  　]","g");n.isEmailValid=function(n){return n.length>5&&1===n.countOccurences("@")&&n.indexOf(",")<0&&n.indexOf("[")<0&&e(n).indexOf(" ")<0&&n.indexOf("'")<0&&n.lastIndexOf(".")>n.indexOf("@")&&!n.endsWith(".")&&n.indexOf("..")<0&&n.indexOf(";")<0&&n.indexOf("`")<0&&n.indexOf(" ")<0&&n.indexOf(")")<0&&n.indexOf("(")<0&&n.indexOf("*")<0&&!t(n)},n.errorMatches=function(e,t){if(e&&e.message)for(var n=0;n<t.length;n++)if(e.message.toLowerCase().indexOf(t[n])>=0)return!0;return!1};var a=$("body");return n.isProUser=function(){return"true"===a.attr("data-pro-user")},n.getIpCountry=function(){return""},n.parseInsertAt=function(e,t){if(!e)return{};const n=e.split(":"),o=t.find("#"+n[0]),a="after"===n[1];return{page:o,insertAfter:a}},n.sanitizeHTML=function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")},n.sanitizeHTMLAllowTags=function(e){function t(e){if(e.nodeType===Node.ELEMENT_NODE){const a=e.tagName.toLowerCase();if(n.indexOf(a)===-1)return void e.parentNode.removeChild(e);const r=Array.from(e.attributes);if(r.forEach(function(t){const n=t.name.toLowerCase();if(o[a]&&o[a].indexOf(n)!==-1)if("href"===n)try{const i=new URL(t.value);"http:"!==i.protocol&&"https:"!==i.protocol&&e.removeAttribute("href")}catch(t){e.removeAttribute("href")}else"target"===n?["_blank","_self","_parent","_top"].indexOf(t.value)===-1&&e.removeAttribute("target"):"class"===n&&(/^[a-zA-Z0-9\s_-]+$/.test(t.value)||e.removeAttribute("class"));else e.removeAttribute(t.name)}),"a"===a&&!e.hasAttribute("href")){const s=e.textContent;return void e.parentNode.replaceChild(i.createTextNode(s),e)}for(var c=e.childNodes.length-1;c>=0;c--)t(e.childNodes[c])}else{if(e.nodeType===Node.TEXT_NODE)return;e.parentNode.removeChild(e)}}if("string"!=typeof e)return"";const n=["a","br"],o={a:["href","class","target"]},a=new DOMParser,i=a.parseFromString(e,"text/html"),r=i.body;for(var s=r.childNodes.length-1;s>=0;s--)t(r.childNodes[s]);const c=r.innerHTML,u=c.replace(/href="([^"]+)"/g,function(e,t){return'href="'+t.replace(/&amp;/g,"&")+'"'});return u},n}(),$(document).on("click","a",function(){this.href&&this.href.startsWith("https://www.sejda.com/")&&window.sejdaContext.electron.app.externalLinkClicked()}),Sejda.Viewer=function(){var e={};return e.open=function(e){var t=encodeURIComponent(e);window.open("./viewer.ejs?file="+t,"viewerPopup","width=1100, height=700")},e.show=function(e,t){var n="file://"+window.sejdaContext.general.utils.urlEncodeFilePath(t),o="public/js/pdfjs/web/viewer.html?file="+encodeURIComponent(n)+"#pagemode=none";e.attr("src",o)},e}(),function(){const e=window.sejdaContext.node.fse.currentDir(),t=/^[ -~]+$/;t.test(e)||window.Sejda.Toasts.showMessage({title:"Problem detected",message:"Installation location contains non-ASCII characters.<br>Please reinstall the app to &quot;C:&bsol;Program Files&quot;",kind:"error"});var n=0;$(document).on("reportJsErrorPrompt",function(){n++,n<=1&&window.Sejda.Toasts.showMessage({title:"We detected an error.",message:'Sorry, this shouldn\'t have happened. <a href="javascript://" class="bug-report-btn">Send bug report</a>.',kind:"error"})})}(),function(){Sejda.AppWindow=function(){const e={},t={firstFile:"",total:0};return e.setDefaultTitle=function(){window.sejdaContext.electron.app.setTitle(""),t.firstFile="",t.total=0},e.setTitleBasedOnFiles=function(n){try{if(!Array.isArray(n)||0===n.length)return e.setDefaultTitle();const o=n[0].name||window.sejdaContext.node.path.basename(n[0])||n[0];t.firstFile||(t.firstFile=o),t.total+=n.length;var a=t.firstFile;t.total>1&&(a+=" and "+(t.total-1)+" more"),window.sejdaContext.electron.app.setTitle(a)}catch(e){Raven.captureException(e)}},e.setMenuPageActions=function(e){e.forEach(function(e){const t=e.callback;$(document).on("appMenuClicked",function(n,o){o===e.id&&t()}),delete e.callback}),window.sejdaContext.electron.menu.setPageActions(e)},e}(),Sejda.AppWindow.setDefaultTitle(),Sejda.referrer=sessionStorage.getItem("referrer")||"",sessionStorage.setItem("referrer",window.location.href),Sejda.referrer.includes("open-with.ejs?files=")&&!window.location.href.includes("open-with.ejs")&&$("#viewerBackHeaderLink").on("click",function(){window.location.href=Sejda.referrer}).show()}(),Sejda.Images=function(){function e(e){try{return e.slice(0,8).arrayBuffer().then(function(e){var t=new Uint8Array(e);return new Promise(function(e,n){var o=137===t[0]&&80===t[1]&&78===t[2]&&71===t[3]&&13===t[4]&&10===t[5]&&26===t[6]&&10===t[7];e(o)})})}catch(e){return Promise.resolve(!1)}}function t(e){const t={canvas:!0,maxHeight:3e3,maxWidth:3e3};return new Promise(function(n,o){loadImage(e,t).then(function(t){return"error"===t.type?(console.error(t),o(new Error("Load image error"))):void t.image.toBlob(function(e){n(e)},e.toParams.toType,e.toParams.toQuality)}).catch(function(e){console.error("Failed loading image"),o(e)})})}function n(e){return t(e)}function o(t){return new Promise(function(n,o){const a=t.ext.toLowerCase();t.toParams={toType:"image/jpeg",toQuality:.8,toExt:"jpeg"},"png"!==a&&"gif"!==a&&"svg"!==a&&""!==a||(t.toParams.toType="image/png",t.toParams.toExt="png"),e(t).then(function(e){e&&(t.toParams.toType="image/png",t.toParams.toExt="png"),n(t)}).catch(function(e){console.error("isPng failed",e),n(t)})})}const a={};return a.convertImages=function(e,t){var a=Promise.resolve();if(e.length>10)return console.log("Skip converting batch of ",e.length),a;for(var i=0;i<e.length;i++){const r=e[i],s=parseFilename(r.name),c=s[0],u=s[1];r.basename=c,r.ext=u;try{const l=i,d=r.type&&r.type.startsWith("image/")&&""!==r.ext&&"editor-attachment"!==t&&r.size<2e7;d&&(a=a.then(function(){return new Promise(function(t,a){o(r).then(n).then(function(n){try{delete r.size,Object.assign(n,r),n.name=r.basename+"."+r.toParams.toExt,e[l]=n,Analytics.trackNoPushEvent("image-conversion","success",r.ext),t()}catch(e){a(e)}}).catch(function(e){console.log("Could not convert image",r.name),Analytics.trackEvent("image-conversion","failure",r.ext),a(e)})})}))}catch(e){console.error("Failure processing image file",r.name,e),Raven.captureException(e),Analytics.trackEvent("image-conversion","failure",r.ext)}}return a},a}(),Sejda.I18n=function(){function e(e){var t=o[e];return"undefined"==typeof t&&(t=window.sejdaContext.electron.app.i18n.__(e),"undefined"!=typeof t&&(o[e]=t)),t===e?void 0:t}function t(t){const n=e(t);if("undefined"!=typeof n)return n;if(!n&&t.endsWith(".")){const o=e(t.dropRight(1));if(o)return o+"."}const a=". ",i=t.split(a).map(function(e){return e.trim()});if(1===i.length){const n=e(t);if(!n)return t}const r=i.map(function(e){return s_i18n(e)});return r.join(a)}const n={},o={};return $(".i18n-strings").find("[data-key]").each(function(){const e=$(this).attr("data-key"),t=$(this).text();o[e]=t,!e.endsWith(".")||e.endsWith("...")||e.endsWith("etc.")||console.warn("i18n key trailing dot:",e)}),window.s_i18n=function(e){try{return t(e)}catch(t){return e}},n}(),Sejda.Blobs=function(){const e={};return e.blobToDataURL=function(e,t){const n=new FileReader;n.onload=function(e){t(e.target.result)},n.readAsDataURL(e)},e}(),$(function(){$("#support-menu-item").click(function(e){e.preventDefault(),$(document).trigger("showContactForm")}),$("#about-menu-item").click(function(e){e.preventDefault(),$("#about-dialog").modal()}),$("#purchase-menu-item").click(function(e){$(".existing-license-btn:first").click()}),$(".contact-btn").click(function(e){e.preventDefault(),$(document).trigger("showContactForm")})}),$(function(){function e(){s.removeClass("active"),r.hide(),$("body").removeClass("mega-menu-open"),$(".mega-menu-backdrop").remove(),u.css("background-color",""),l.removeClass("light"),$(document).unbind("keyup.mega-menu")}function t(){s.addClass("active"),r.show(),$("body").addClass("mega-menu-open"),l.addClass("light"),$(".mega-menu-backdrop").remove(),$('<div class="mega-menu-backdrop"/>').insertAfter(u).click(function(){e()}),u.css("background-color","#FBFBFB"),$(document).on("keyup.mega-menu",function(t){27===t.keyCode&&e()}),window.scrollTo(0,0),r.find("li a").each(function(){const e=$(this),t=e.width(),n=e.parents(".col").width();t>n&&e.addClass("shrinked")})}function n(){s.hasClass("active")?e():t()}function o(){var e=c.val().toLowerCase(),t=r.find("li a");return 0==e.trim().length?void t.removeClass("search-not-matching"):(t.addClass("search-not-matching"),void t.each(function(){var t=$(this),n=(t.text()||"").toLowerCase(),o=(t.attr("title")||t.attr("data-original-title")||"").toLowerCase(),a=n.indexOf(e)>=0||o.indexOf(e)>=0;a&&t.removeClass("search-not-matching")}))}function a(){try{var e=window.location.pathname.substring(window.location.pathname.lastIndexOf("/")+1,window.location.pathname.length).toLowerCase();if(0==r.find('a[href="'+e+'"]').length)return;var t=i();t.indexOf(e)>=0||(t.unshift(e),t=t.slice(0,7),Sejda.LocalStorage.setItem("prevUsedTools",JSON.stringify(t)))}catch(e){}}function i(){try{const e=JSON.parse(Sejda.LocalStorage.getItem("prevUsedTools"))||[];return e}catch(e){return[]}}var r=$("#megaMenu"),s=$(".more-tasks"),c=$("#searchTools"),u=$("header"),l=$("#viewerHeaderLink");$(".suggest-task-btn").click(e),$(document).on("hideNavSidebarImmediately",e),s.hoverIntent(t,function(){}).click(n),r.find(".close").click(e),c.keyup(o);const d=["compress-pdf.ejs","pdf-editor.ejs","extract-pdf-pages.ejs","merge-pdf.ejs","crop-pdf.ejs"],f=r.find("ul.popular"),p=i();var g=p.concat(d);g=g.filter(function(e,t){return g.indexOf(e)===t}),g=g.slice(0,8),g.forEach(function(e){const t=r.find('a[href="'+e+'"]').parents("li").clone();f.append(t)}),p.forEach(function(e){r.find('a[href="'+e+'"]').addClass("recently-used")}),a(),r.find("li a").each(function(){const e=$(this),t=e.find(".description").text();e.attr("title",t)}),$(".mega-menu li a").tooltip(tooltipOpts)}),$(function(){function e(){for(var e=navigator.userAgent,t=9;t<13;t++)if(e.includes("Mac OS X 10_"+t))return console.log("Unsupported Mac OS X detected:"+e),!0;return!1}if(!sessionStorage["news-checked"]){sessionStorage["news-checked"]=!0;const t=window.sejdaContext.general.prefs;var n=t.get();if("off"===n.updateCheck||"false"===n.updateCheck)console.log("Update checks are disabled");else{const o=window.sejdaContext.general.appManifest,a="id="+encodeURIComponent(o.identifier)+"&version="+encodeURIComponent(o.version);$.jsonGet("/news/desktop?"+a,function(e){if(e&&e.id){var t="news-"+e.id;localStorage[t]||window.Sejda.Toasts.showMessage({title:e.title,message:e.message,onClose:function(){localStorage[t]=!0}})}})}e()&&$("#unsupportedMacOSXVersion").show()}}),$(function(){function e(){var e=parseInt($(window).height())-120;$("#eula-iframe").css({height:e+"px"})}$(window).resize(e),e()}),$(function(){function e(){n.reloadLicenseData();var e=n.hasLicense()&&!n.licenseExpired();e?(o.text("PRO").attr("data-status","pro").off("click").show(),$("body").attr("data-pro-user","true"),a.hide()):(o.html('Free limited version <i class="fal fa-question-circle"></i>').attr("data-status","free").off("click").on("click",function(){$(document).trigger("hideNavSidebarImmediately"),Screens.showFreeVersionLimits()}).show(),$("body").removeAttr("data-pro-user"),a.show())}if(0!==$("#licensing-section").length){const t=window.sejdaContext.general.prefs;Sejda.Onboarding={},Sejda.Onboarding.Eula=function(){function e(){Sejda.LocalStorage.setItem(n,"true")}function t(){return"true"===Sejda.LocalStorage.getItem(n)}const n="accepted-eula-v30-03-2020";return{markAcceptedEula:e,isAcceptedEula:t}}(),Sejda.Onboarding.ErrorReporting=function(){function e(e){t.set({autoReportErrors:e?"true":"false"}),Sejda.LocalStorage.setItem(o,"true")}function n(){return"true"===Sejda.LocalStorage.getItem(o)}const o="reviewed-privacy-v26-03-2021";return{isAnsweredAllowErrorReporting:n,answerAllowErrorReporting:e}}(),window.Screens=function(){function e(){$(".license-screen").hide(),$(".modal-backdrop").remove()}function t(t){e(),$("body").append('<div class="modal-backdrop licensing-screen-backdrop" style="opacity: 0.5"></div>'),t.addClass("with-backdrop"),t.show()}const n={};n.hideAll=e,$(document).on("click",".license-screen .close",function(){e()}),n.hideLicenseExpired=function(){$("#license-expired").hide()},n.showWithBackdrop=t,n.showLicenseVerifyFail=function(n){var o=$("#license-verify-fail");e(),t(o),o.find("[data-reason]").hide();var a=o.find('[data-reason="'+n+'"]');0===a.length&&(a=o.find('[data-reason="unknown"]')),a.show()},n.showThanksForUpgrading=function(){t($("#license-just-upgraded"))};var o=$("#license-expired");return n.showLicenseExpired=function(){e();var t="yes"===Sejda.LocalStorage.getItem("licenseExpiredDismissed");t||o.show()},o.find(".close").click(function(){Sejda.LocalStorage.setItem("licenseExpiredDismissed","yes")}),$(document).on("licenseVerifySuccess",function(){Sejda.LocalStorage.removeItem("licenseExpiredDismissed")}),n.showLicenseBlocked=function(e){var n=$("#license-blocked");e&&n.find("h4").html(Sejda.Utils.sanitizeHTMLAllowTags(e)),t(n)},n.showLicenseExpiresSoon=function(e){var t=$("#license-expires-soon");t.find(".days-count").text(e),t.show()},n.showEnterLicenseKey=function(){var n=$("#license-enter-existing");e(),t(n),setTimeout(function(){n.find("input").first().focus()},300)},n.showAcceptEula=function(){t($("#license-accept-eula"))},n.showReviewPrivacy=function(){t($("#review-privacy"))},n.showFreeVersionLimits=function(){t($("#free-version-limits"))},n}();var n=function(){function e(e){window.sejdaContext.licensing.getLicenseData(function(t){t.licenseKey=d,e(t)})}function n(){t.set({licenseKey:""})}function a(e){e=e||{},e.expires=e.expires||0,e.token=e.token||"",t.set({licenseExpires:e.expires}),t.set({licenseToken:e.token})}function i(t,n,o){e(function(e){e.licenseKey=t,$.jsonPost("/licenses/verify",e).done(function(e){n(e),$(document).trigger("licenseVerifySuccess")}).fail(function(e){o(e)})})}function r(e,t){if(402===e.status){var n,o,a="unknown";try{var i=JSON.parse(e.responseText);a=i.code,o=i.reason,n=i.license}catch(e){}t(a,n,o)}}function s(){i(d,function(e){sessionStorage.licenseVerified=!0,a(e),Screens.hideLicenseExpired()},function(e){r(e,function(e,t,o){sessionStorage.licenseVerified=!0,"blocked"===e?(Sejda.LocalStorage.licenseBlocked=!0,Screens.showLicenseBlocked(o)):""!==d&&("expired"===e?Screens.showLicenseExpired():("access_revoked"===e&&n(),Screens.showLicenseVerifyFail(e))),a(t)})})}const c={};var u=(new Date).getTime(),l=t.get(),d=l.licenseKey||"",f=l.licenseExpires||u;return c.reloadLicenseData=function(){l=t.get(),d=l.licenseKey||"",f=l.licenseExpires||u},c.resetLicenseData=function(){t.set({licenseKey:"",licenseExpires:u}),c.reloadLicenseData()},c.shouldVerifyLicense=function(){return!sessionStorage.licenseVerified},c.submitLicense=function(e){i(e,function(n){t.set({licenseKey:e}),a(n),Screens.hideAll(),Screens.showThanksForUpgrading(),c.reloadLicenseData(),$(document).trigger("upgradeStateChanged"),$("#top-upgrade-section-wrap").hide()},function(e){r(e,function(e,t,n){"expired"===e?Screens.showLicenseExpired():"blocked"===e?(Sejda.LocalStorage.licenseBlocked=!0,Screens.showLicenseBlocked(n)):Screens.showLicenseVerifyFail(e)})})},c.hasLicense=function(){return""!==d},c.licenseExpired=function(){return f<=u},c.bindOnAboutDialog=function(){$("#about-menu-item").on("click",function(){c.reloadLicenseData();var e=$("#registeredDetails");d?e.text("PRO active — "+d):e.text("Free limited version")})},c.initialize=function(){if(o.hide(),!Sejda.Onboarding.Eula.isAcceptedEula()){if(l.eulaAcceptedAdmin!==!0)return Screens.showAcceptEula();Sejda.Onboarding.Eula.markAcceptedEula()}if(Sejda.LocalStorage.licenseBlocked)return Screens.showLicenseBlocked();if(!Sejda.Onboarding.ErrorReporting.isAnsweredAllowErrorReporting()){const e=l.autoReportErrorsAdmin;if("undefined"==typeof e)return Screens.showReviewPrivacy();Sejda.Onboarding.ErrorReporting.answerAllowErrorReporting(e)}o.show(),c.shouldVerifyLicense()&&s(),c.hasLicense()||$("#top-upgrade-section-wrap").show()},c}();$(".ok-continue-btn").click(function(){Screens.hideAll()}),$(".buy-btn").click(function(){Screens.showEnterLicenseKey()}),$("#enter-key-menu-item").click(function(){Screens.showEnterLicenseKey()});var o=$(".licensing-status-app-btn"),a=$("#freeLimitsSection");$(document).on("upgradeStateChanged",e),$(document).on("licenseVerifySuccess",e),$(document).on("upgradeStateChanged",function(){$("#taskResultModal .close").click()}),e(),$(".try-again-btn").click(function(){window.location.reload()}),$(".existing-license-btn").click(function(){Screens.showEnterLicenseKey()}),$(".cancel-existing-license-btn").click(function(){Screens.hideAll()});var i=$("#license-enter-existing");i.find("#licenseKeyInput").keyup(function(e){13===e.keyCode&&i.find(".submit-license-key-btn").click(),27===e.keyCode&&i.find(".cancel-existing-license-btn").click()}),$(".submit-license-key-btn").click(function(){var e=$("#licenseKeyInput").val().trim();if(""!==e){var t=$(this);t.attr("disabled","disabled"),setTimeout(function(){t.removeAttr("disabled")},5e3),n.submitLicense(e)}}),$(".try-this-version-btn").click(function(){n.resetLicenseData(),Screens.hideAll()}),$(".accept-eula-btn").click(function(){Sejda.Onboarding.Eula.markAcceptedEula(),Sejda.Onboarding.Eula.isAcceptedEula()||alert("Error: Failed marking EULA as accepted"),window.location.reload()}),$(".back-eula-btn").click(function(){$("#eula-confirmation").hide("fast",function(){$("#eula-text").show("fast")}),$(".accept-eula-btn").data("first-accepted",!1),$(".back-eula-btn").css("display","none")}),$(".continue-review-privacy-btn, #review-privacy .close").click(function(){var e="true"===$(this).attr("data-allowed");Sejda.Onboarding.ErrorReporting.answerAllowErrorReporting(e),window.location.reload()}),n.initialize(),n.bindOnAboutDialog(),$(document).on("click",".close",function(){$(this).parents(".license-screen").hide()})}});var $fileUploadForm=$("#fileUploadForm"),filetypes=$fileUploadForm.attrOr("data-filetypes","").split(",");$fileUploadForm.find(".fileupload").attr("accept",_.map(filetypes,function(e){return"."+e}));var $secondaryUploadBtnGroup=$(".secondary-upload-btn-group");$secondaryUploadBtnGroup.find(".fileupload").attr("accept",_.map(filetypes,function(e){return"."+e}));var $uploadBtnGroup=$(".upload-btn-group");acceptsFileType("docx")&&($uploadBtnGroup.find(".fa-file-pdf").removeClass("fa-file-pdf").addClass("fa-file-word"),$uploadBtnGroup.find(".singular, .plural").each(function(){changeCaption($(this),"DOCx")})),acceptsFileType("jpeg")&&(acceptsFileType("pdf")?($uploadBtnGroup.find(".fa-file-pdf").removeClass("fa-file-pdf").addClass("fa-copy"),$uploadBtnGroup.find(".singular, .plural").each(function(){changeCaption($(this),"PDF & image")})):($uploadBtnGroup.find(".fa-file-pdf").removeClass("fa-file-pdf").addClass("fa-image"),$uploadBtnGroup.find(".singular, .plural").each(function(){changeCaption($(this),"image")})));var PdfFilesPwd=function(){var e=void 0;const t=[];var n=1;return{prompt:function(o){function a(e){r(e),$(document).trigger("filePassword",{file:i,password:e})}const i=o.file,r=o.callback,s=o.cancelCallback,c=o.isOwnerPwd,u=o.permissions,l=o.canClose;if(!c&&e&&t.indexOf(i.counter)<0)return t.push(i.counter),a(e);const d=c?"fileOwnerPwdPrompt":"filePwdPrompt",f=$("#"+d).clone().attr("id",d+n++);f.find(".file-name").text(i.name.truncateMiddle(30)),l!==!0&&f.find(".modal-header button.close").remove();const p=f.find(".btn-primary");p.click(function(){const t=f.find("input[name=filePwd]").val();if(t){if(c)return p.disable(),void PdfFiles.checkOwnerPwd(i,t,function(e){if(p.enable(),e===!0)a(t),f.modal("hide"),f.remove();else{f.find(".alert-danger").show();const n=f.find(".file-pwd");n.blur(),n.val(""),n.attr("type","text"),n.focus()}});a(t),f.modal("hide"),f.remove();const n=(f.find("[name=usePwdForAllFiles]").get(0)||{}).checked;n&&(e=t,$(".modal.file-pwd-prompt").not(f).each(function(){const e=$(this);e.find("input[name=filePwd]").val(t),(e.find("[name=usePwdForAllFiles]").get(0)||{}).checked=!1,e.find(".btn-primary").click()}))}}),c&&u&&(f.find(".file-permissions-list [data-perm]").each(function(){const e=$(this);u.indexOf(e.attr("data-perm"))<0?e.remove():e.show()}),0===f.find(".file-permissions-list [data-perm]").length&&f.find(".file-permissions-list").remove()),f.find(".file-pwd").keypress(function(e){13===e.which&&f.find(".btn-primary").click(),27===e.keyCode&&f.find('[data-dismiss="modal"]').click()}),f.find('[data-dismiss="modal"]').click(function(){s&&s()}),f.find("input").keyup(function(){f.find(".alert-danger").hide();const e=$(this),t=e.val();t.length>0?e.attr("type","password"):e.attr("type","text")}),f.on("shown.bs.modal",function(){f.find(".file-pwd").focus()}),f.modal({backdrop:"static",keyboard:!1}),f.modal("show"),f.shake()}}}(),PdfFilesCache=function(){var e={},t={};return e.put=function(e,n){t[e.counter]={pdf:n,file:e}},e.get=function(e){return t[e.counter||e]},e.remove=function(e){delete t[e.counter||e]},e}();const PdfPerms=function(){const e=[],t={Modify:"modify",Print:"print",Copy:"copy",Fill:"fill",Assemble:"assemble",Annotate:"annotate"};return t.All=[t.Modify,t.Print,t.Copy,t.Fill,t.Assemble,t.Annotate],t.deny=function(t){e.indexOf(t)<0&&e.push(t)},t.isAllowed=function(t){return e.indexOf(t)<0},t.isAllowedModify=function(){return t.isAllowed(t.Modify)},t.isAllowedAnnotate=function(){return t.isAllowed(t.Annotate)},t.isAllowedFill=function(){return t.isAllowed(t.Fill)},t.update=function(e,n){return null===e?t.allowAll():(e.includes(n.PermissionFlag.PRINT)||t.deny(t.Print),e.includes(n.PermissionFlag.MODIFY_CONTENTS)||t.deny(t.Modify),e.includes(n.PermissionFlag.COPY)||t.deny(t.Copy),e.includes(n.PermissionFlag.MODIFY_ANNOTATIONS)||t.deny(t.Annotate),e.includes(n.PermissionFlag.FILL_INTERACTIVE_FORMS)||t.deny(t.Fill),void(e.includes(n.PermissionFlag.ASSEMBLE)||t.deny(t.Assemble)))},t.listDenied=function(){return e.slice().sort()},t.allowAll=function(){for(;e.length>0;)e.pop()},t};var PdfFiles=function(){return{checkOwnerPwd:function(e,t,n){Sejda.PDFJS.load().then(function(o){new Promise(function(t,n){e.link?t(e._pdfjsOpts):console.error("Cannot open file:",e)}).then(function(e){const a=$.extend({},o.GlobalGetDocumentOptions,e,{password:t});window.globalWorkerInstance=window.globalWorkerInstance||new o.PDFWorker,a.worker=globalWorkerInstance,o.getDocument(a).promise.then(function(e){e.isOwnerPasswordUsed().then(n)}).catch(function(e){return console.error(e),n(!1)})})})},getDocument:function(e,t,n,o){function a(t){console.error(t),t&&"InvalidPDFException"!==t.name&&"MissingPDFException"!==t.name&&"UnexpectedResponseException"!==t.name&&"UnknownErrorException"!==t.name&&"NoPagesException"!==t.name&&Raven.captureException(t),showAlert('Could not open file "'+e.name.truncateMiddle(15)+'"'),n(t)}function i(n){if(0===n.numPages){const o=new Error("No pages");o.name="NoPagesException",a(o)}else PdfFilesCache.put(e,n),t(n)}function r(t,o){PdfFilesPwd.prompt({file:e,callback:function(e){t(e)},cancelCallback:function(){n()}})}function s(e){return Sejda.PDFJS.load().then(function(t){const n=$.extend({},t.GlobalGetDocumentOptions,e);window.globalPdfJS=t,window.globalWorkerInstance=window.globalWorkerInstance||new t.PDFWorker,n.worker=globalWorkerInstance;var a=t.getDocument(n);return a.onPassword=r,a.onProgress=c,a.onUnsupportedFeature=o,a.promise})}Date.now();n=n||function(){},o=o||function(t){console.error("Detected unsupported pdfjs feature:",t),Analytics.trackEvent("pdfjs","unsupported_feature",t),"warnIndexingAllObjects"===t&&showAlert(s_i18n("Errors were detected when reading document:")+" "+e.name,"warning")};var c=function(e){},u=PdfFilesCache.get(e);if(u)return t(u.pdf);if("undefined"==typeof e.link&&(e.link="file://"+window.sejdaContext.general.utils.urlEncodeFilePath(e.path)),e.link){var l={url:e.link,httpHeaders:e.httpHeaders};e._pdfjsOpts=l,s(l).then(i).catch(a)}else console.error("Cannot open file:",e)}}}();Sejda.PagesPicker=function(){var e={},t=$("#pdf-canvas-list3"),n=$("#pagesPickerModal");return t.scrollStopped(function(){$(document).trigger("renderVisiblePageThumbs")}),e.show=function(e){return new Promise(function(o,a){t.empty(),t.addClass("loading"),n.find(".btn-ok").off("click").on("click",function(){var e=t.find(".pdf-page-wrap.selected").map(function(){return parseInt($(this).attr("data-page"))}).toArray();n.modal("hide"),$("input[name=mode][value=page]").parent("label").click(),o(e)}),n.modal("show"),$(document).trigger("requestRenderPages",{files:e,$target:t,callback:function(){t.removeClass("loading")}})})},e}(),$(function(){function e(e){var t=$("#pdf-files-summary-wrap");t.find(".message").text(e),t.fadeIn(),e.endsWith("files selected")&&t.addClass("multiple")}function t(t){var n=Sejda.SelectedFiles.getCount();n>0&&(e(Sejda.SelectedFiles.getSummary()),u())}function n(e){return function(t,n){function a(){r+=1;var e=Math.floor(r/t.length*100);o(e)}function i(){r>0&&($(".doc-loading").hide(),c(),e(t,r))}var r=0;return t.length>20?e(t,r):(s(),$(".doc-loading").show(),void l(t,a,i,n))}}function o(e){var t=$(".doc-loading").find(".progress-radial");t.find(".overlay").text(e+"%");var n=5*Math.floor(e/5);C<n&&(t.removeClass("progress-"+C).removeClass("progress-100").addClass("progress-"+n),C=n,100===n&&$(".doc-loading").hide())}function a(e){var t=e.files,n=e.$target||S,o=e.callback||function(){},a=e.onlyPages||[];if(0===t.length)return $(".doc-loading").hide(),o();const i=[];var r=!1;t.forEach(function(e){const t=parseFilename(e.name),o=t[0],s=t[1];e.basename=o,e.ext=s,r===!1&&(r=!0,$("#pdf-canvas-wrap").show(),$("html, body").animate({scrollTop:200},1e3)),i.push(new Promise(function(t,o){if("pdf"===s)PdfFiles.getDocument(e,function(o){const i=[];for(var r=1;r<=o.numPages;r++)if(!(a.length>0&&a.indexOf(r)<0)){const s=Sejda.Rendering.renderPdfPage(o,e,r,window.globalPdfRenderOpts);i.push(s)}if(e.insertAt){const c=Sejda.Utils.parseInsertAt(e.insertAt,n),u=c.page;0===u.length?(console.warn("Could not determine insertion point",e.insertAt,i.length),n.append(i)):c.insertAfter?(i.reverse(),i.forEach(function(e){e.insertAfter(u)})):i.forEach(function(e){e.insertBefore(u)})}else n.append(i);t()});else if(["png","gif","jpg","jpeg","tif","tiff","bmp","webp"].indexOf(s)>=0){const i=Sejda.Rendering.renderImagePage(e);if(e.insertAt){const r=Sejda.Utils.parseInsertAt(e.insertAt,n),c=r.page;0===c.length?(console.warn("Could not determine insertion point",e.insertAt),n.append(i)):r.insertAfter?i.insertAfter(c):i.insertBefore(c)}else n.append(i);t()}else Analytics.trackEvent("error","unknownExtension",e.name),console.error("Unknown extension:",e.name),showAlert("Missing file extension: "+e.name)}))}),Promise.all(i).then(function(){$(document).trigger("pagesRendered",{files:t,$elem:n}),$(document).trigger("renderVisiblePageThumbs"),o()})}function i(e){var t=e.pdf,n=e.file,o=e.pageNum,a=e.callback||function(){},i=e.target||document.getElementById("pdf-canvas-page-"+n.counter+"-"+o),r=$(i);"true"!==r.attr("data-rendered")&&(r.attr("data-rendered","true"),t.getPage(o).then(function(s){var c=e.desiredWidth||300,u=s.getViewport({scale:1}),l=c/u.width,d=s.getViewport({scale:l}),f=i.getContext("2d");i.height=d.height,i.width=d.width,r.css("height","").attr({"data-scale":l,"data-v-width":u.width,"data-v-height":u.height});var p={canvasContext:f,viewport:d},g=s.render(p);return g.promise.then(function(){e.target||$(".pdf-canvas-page-"+n.counter+"-"+o).not("[data-rendered=true]").each(function(){var e=this;$(e).attr("data-rendered","true").css("height","");var t=this.getContext("2d");e.width=i.width,e.height=i.height,t.drawImage(i,0,0)}),a(null),$(document).trigger("pdfPageRenderedLazy",{file:n,pageNum:o,pdf:t}),s.cleanup(),s=null},function(e){a(e),s.cleanup(),s=null})}))}function r(){$(".pdf-page-wrap").each(function(){var e=$(this);if(e.isInViewport()){var t=parseInt(e.attr("data-page")),n=e.attr("data-file-counter");$(document).trigger("doRenderPage",{page:t,counter:n})}})}function s(){$(".step1").hide(),$("#how-it-works").remove()}function c(e){$(".step2").show(),$(document).trigger("showStep2"),"edit"!==e&&"fillSign"!==e&&$("html, body").animate({scrollTop:200},1e3)}function u(e){E||(E=!0,s(),c(e),$("#changeLanguageNotice").hide())}function l(e,t,n,o){function a(e){t(s),new Promise(function(t,n){e.getPermissions().then(function(e){if(null===e);else if("owner_all"===r)return PdfFilesPwd.prompt({file:s,callback:function(){Analytics.trackNoPushEvent("perms","unlocked"),t()},cancelCallback:function(){t()},isOwnerPwd:!0,permissions:[],canClose:!0});return t()})}).then(function(){o&&e.destroy()}),l(c,t,n)}function i(e){l(c,t,n)}if(0===e.length)return n();o=o||!1;const r=y.attr("data-require-perms");var s=e[0],c=e.slice(1);PdfFiles.getDocument(s,a,i)}function d(e){if(Sejda.SelectedFiles.isFirstFileBatch())return f([e[0]])}function f(e){u();var t=1===e.length&&e[0].pickPages;t?Sejda.PagesPicker.show(e).then(function(t){$(document).trigger("requestRenderPages",{files:e,$target:$("#pdf-canvas-list"),onlyPages:t})}):a({files:e,$target:S})}function p(e){u();for(var t=0,n=e.length;t<n;t++){const o=e[t],a=Sejda.Rendering.renderImagePage(o);A.append(a);
}$(document).trigger("imagePagesRendered",{files:e}),$("#image-canvas-wrap").show(),Sejda.SelectedFiles.isFirstFileBatch()&&$("html, body").animate({scrollTop:200},1e3)}function g(e,t,n){if(0===e.length)return[];var o=_.filter(e,function(e){var n=e.name.toLowerCase(),o=_.find(t,function(e){return n.endsWith("."+e)});return void 0!==o||0===t.length});return n&&e.length!==o.length&&(0===o.length?showAlert("Please select "+t.join(", ").toUpperCase()+" files"):showAlert("Some files were ignored, please select only "+t.join(", ").toUpperCase()+" files","warning")),o}function m(e,t){if(0===e.length)return[];var n=_.filter(e,function(e){return"undefined"==typeof e.size||e.size>0});return t&&e.length!==n.length&&(0===n.length?showAlert("Unreadable file"):showAlert("Some files were ignored, unreadable files","warning")),n}function h(e){_.each(e,function(e){"undefined"==typeof e.counter&&(e.counter=D++)})}function w(e,t){const n=$("#"+t.attr("id")),o=n.hasClass("can-pick-pages")||n.parents(".upload-btn-group").hasClass("can-pick-pages")||n.parents(".can-pick-pages").hasClass("can-pick-pages");e.forEach(function(e){e.pickPages=o});const a=n.parents("[data-insert-at]").attr("data-insert-at");e.forEach(function(e){e.insertAt=a})}function v(e,t,n){w(t.files,n);var o=t.files,a=$(e.target),i=a.attr("data-scope");_.each(o,function(e){e.scope=e.scope||i}),h(o),$(document).trigger("filesOtherSelected",{files:o})}function b(e,t,n){w(t.files,n);var o=t.files;if(k){if(!(o&&o.length>0))return console.log("No files to handle");if(j)return void console.log("Refusing to handle files again");j=!0}var a=$(e.target),i=a.attr("data-scope")||"task-file";_.each(o,function(e){e.scope=e.scope||i});var r=_.map(o,function(e){return e}),s="task-file"===i?filetypes:[],c=g(r,s,!0);if(c=m(c,!0),"false"===y.attr("data-multiple-files")&&c.length>1&&(c=[c[0]]),t.files=c,0===c.length)return void(j=!1);if(h(c),"edit"===P||"fillSign"===P)try{c.length>0&&(c[0]._path=window.sejdaContext.node.fse.createTmpCopy(c[0].path))}catch(e){console.error("Failed making a tmp copy of the input file: "+c[0].path),console.error(e)}1===t.files.length&&"task-file"===t.files[0].scope&&Sejda.RecentFiles.add(t.files[0].path,"open"),$(document).trigger("filesSelected",{files:c})}function F(e){if(e&&e.length>0){const t=[];for(var n=0;n<e.length;n++){const o=e[n],a=window.sejdaContext.node.path.basename(o);var i=0;try{i=window.sejdaContext.node.fse.getFileSize(o)}catch(e){if(e.message&&e.message.indexOf("ENOENT")>=0)return void showAlert("File no longer found on disk: "+a)}t.push({name:a,size:i,path:o,link:"file://"+window.sejdaContext.general.utils.urlEncodeFilePath(o)})}setTimeout(function(){var e=$(".fileupload").first();e.trigger("fileuploadchange",{files:t}),e.fileupload("add",{files:t})},200)}}var C=0;$(".upload-btn-group").css("opacity","1");var y=$("#task-content"),k="false"!=y.attr("data-drop-files-once");canMaybeMultiple()||($(".fileupload").removeAttr("multiple"),$(".upload-btn-group").find(".plural").hide(),$(".upload-btn-group").find(".singular").show());const S=$("#pdf-canvas-list"),A=$("#image-canvas-list");$(document).on("requestRenderPages",function(e,t){a(t)}),Sejda.FileUploadPromises=function(){var e={},t={};return e.get=function(e){if(!e)throw new Error("LocalId is empty");return t[e]||(t[e]=new Promise(function(t,n){$(document).on("fileUploadDone",function(n,o){if(o.localId===e)return t(!0,o)}),$(document).on("fileUploadFailed",function(n,o){if(o.localId===e)return t(!1,o)})})),t[e]},e}(),Sejda.Thumbs=function(){const e={};return e.getSize=function(){return parseInt(Sejda.LocalStorage.getItem("thumbnails-size"))||165},e.setSize=function(e){Sejda.LocalStorage.setItem("thumbnails-size",e)},e}(),Sejda.Rendering=function(){function e(e,t,a,i){i=i||{};const r=i.width||Sejda.Thumbs.getSize(),s=t.basename||parseFilename(t.name)[0],c=$('<li class="pdf-page-wrap">'+(i.noPageToolBtns?"":n)+'<canvas class="pdf-page magnify pdf-canvas-page-'+t.counter+"-"+a+'" style="height: 210px;" id="pdf-canvas-page-'+t.counter+"-"+a+'"></canvas>'+o+"</li>");c.attr("id","pdfPageWrap"+a+"f"+t.counter);const u=r/150;c.find(".pdf-page,.pdf-page-number,.pdf-file-title").css("width",r+"px").css("max-height",Math.round(210*u)+"px");var l="";return i.useLetterPrefix&&(l=String.fromCharCode(t.counter+65-1)),c.find(".pdf-page-number").text(l+a).attr("title","Page "+a+" of "+t.name),c.find(".page-file-title").text(s.truncateMiddle(30)).attr("title",t.name),c.find(".page-tools-btns .btn").tooltip(tooltipOpts),c.attr({"data-filename":encodeURIComponent(t.name),"data-filename-raw":t.name,"data-lastmod":t.lastModified,"data-file-counter":t.counter,"data-page":a}),$(document).trigger("pdfPageRendered",{file:t,pageNum:a,$elem:c}),c}function t(e){function t(t){const n=URL.createObjectURL(t);s.find("img").attr("src",n),$('.pdf-page-wrap[data-file-counter="'+e.counter+'"]').find("img").attr("src",n)}const a=Sejda.Thumbs.getSize(),i=parseFilename(e.name),r=i[0],s=(i[1],$('<li class="pdf-page-wrap" data-filename="'+encodeURIComponent(e.name)+'" data-file-counter="'+e.counter+'">'+n+'<div class="image-page" id="image-canvas-page-'+e.counter+'"><span class="image-page-helper"></span><img src=""/></div>'+o+"</li>")),c=1;s.find(".pdf-page-number").text(r.truncateMiddle(30)).attr("title",e.name),s.find(".page-file-title").text(r.truncateMiddle(30)).attr("title",e.name),s.find(".page-tools-btns .btn").tooltip(tooltipOpts),s.attr({"data-filename":encodeURIComponent(e.name),"data-filename-raw":e.name,"data-lastmod":e.lastModified,"data-file-counter":e.counter,"data-page":c,id:"pdfPageWrap1f"+e.counter});const u=210/297;if(s.find(".image-page").css("width",a+"px").css("height",a/u+"px"),e.link){const l=new XMLHttpRequest;if(l.responseType="blob",l.onreadystatechange=function(){l.readyState===XMLHttpRequest.DONE&&200===l.status&&(t(l.response),$(".doc-loading").hide())},l.open("GET",e.link,!0),e.httpHeaders)for(var d in e.httpHeaders)e.httpHeaders.hasOwnProperty(d)&&l.setRequestHeader(d,e.httpHeaders[d]);l.send()}else t(e);return $(document).trigger("pdfPageRendered",{file:e,pageNum:c,$elem:s}),$(document).trigger("imagePageRendered",{file:e}),s}const n='<div class="page-tools-btns"><div class="btn-group" role="group"><button type="button" class="btn btn-default btn-xs page-tools-btn page-tools-magnify-btn" title="Enlarge"><i class="fal fa-search-plus"></i></button><button type="button" class="btn btn-default btn-xs page-tools-btn page-tools-rotate-btn" data-rotation="-90" title="Rotate"><i class="fal fa-undo"></i></button><button type="button" class="btn btn-default btn-xs page-tools-btn page-tools-rotate-btn" data-rotation="90" title="Rotate"><i class="fal fa-redo"></i></button><button type="button" class="btn btn-default btn-xs page-tools-btn page-tools-duplicate-btn" title="Duplicate"><i class="fal fa-clone"></i></button><button type="button" class="btn btn-default btn-xs page-tools-btn page-tools-move-btn" title="Move"><i class="fal fa-arrows-alt"></i></button><button type="button" class="btn btn-default btn-xs page-tools-btn page-tools-delete-btn" title="Remove"><i class="fal fa-trash-alt"></i></button></div></div>',o='<div class="pdf-page-number"></div><div class="page-file-title"></div>';return{renderPdfPage:e,renderImagePage:t}}(),$(document).on("doRenderPage",function(e,t){var n=t.page,o=t.counter;t.target,t.desiredWidth;if("undefined"!=typeof n&&"undefined"!=typeof o){var a=PdfFilesCache.get(o);if(a){var r=$.extend({},t);r.pdf=a.pdf,r.file=a.file,r.pageNum=n,i(r)}else console.error("Cant render",n,o,"nothing found in cache")}else console.error("Cant render",n,o," undefined values found")});const x=debounce(r,300);$(document).scrollStopped(function(){x()}),$(document).on("renderVisiblePageThumbs",x);var E=!1,P=y.attr("data-task"),D=1,j=!1,B=$(".doc-loading");Sejda.UnsavedWork=function(){const e={};var t=!1;return null===window.onbeforeunload&&(window.onbeforeunload=function(){if(t)return"Changes that you made may not be saved"}),e.markUnsavedWork=function(){t=!0},e.clearUnsavedWork=function(){t=!1},e}(),Sejda.RecentFiles=function(){function e(){return s.recentFiles.clear()}function t(){s.recentFiles.orderBy("openedDate").reverse().toArray().then(function(e){if(e.length>r){const t=e.slice(r),n=t.map(function(e){return e.path});s.recentFiles.bulkDelete(n)}}).catch(function(e){console.error("Error while pruning recent files:",e)})}const n={},o=window.sejdaContext.node.path,a=$("#recentFilesList"),i=$("#recentFilesListContainer"),r=20,s=new Dexie("recent-files");s.version(1).stores({recentFiles:"path,kind,openedDate"});const c={pdf:"fa-file",png:"fa-file-image",jpg:"fa-file-image",jpeg:"fa-file-image",tif:"fa-file-image",tiff:"fa-file-image"},u=Object.keys(c);$(document).on("click","#recentFilesList li",function(e){e.preventDefault();const t=$(this).attr("data-path");sessionStorage.setItem("files",JSON.stringify([t]));const n=window.top.location.protocol+"//"+window.top.location.hostname+window.top.location.pathname;return window.top.location.href=n,!1});const l=window.sejdaContext.general.prefs,d=l.get(),f=d.showRecentFiles!==!1;f||(i.remove(),e()),$(document).on("click","#recentFilesListContainer .collapse-toggle",function(){const t=$("#recentFilesCollapseModal");t.find(".btn-hide").off("click").on("click",function(){l.set({showRecentFiles:!1}),i.remove()}),t.find(".btn-clear").off("click").on("click",function(){e(),a.empty()}),t.modal("show")}),n.add=function(e,n){const a=o.basename(e),i=parseFilename(a)[1];u.indexOf(i)<0||s.recentFiles.put({path:e,kind:n,openedDate:Date.now()}).then(function(){t()}).catch(function(t){console.error("Error while adding recent file:",e,n)})},n.render=function(){if(f)return s.recentFiles.orderBy("openedDate").reverse().toArray(function(e){e=e||[];var t=0;e.forEach(function(e){const n=o.basename(e.path),i=parseFilename(n)[1],r=o.dirname(e.path);if(window.sejdaContext.node.fse.exists(e.path)&&acceptsFileType(i)){const s=$('<li><a href="javascript://" class="delete-btn"><i class="fal fa-times delete-icon"></i></a><i class="fal file-icon"></i><a href="javascript://" class="open-btn"><span class="name"></span></a><div class="parentDir"></div><span class="chevron"><i class="fal fa-chevron-right"></i></span></li>');s.find(".name").text(n.truncateMiddle(57)).attr("title",n),s.find(".parentDir").text(r),s.attr("data-path",e.path);const u=c[i]||"fa-file";s.find(".file-icon").addClass(u),t%2===0&&s.addClass("even-row"),a.append(s),t++}}),t>0&&p!==!0&&i.show(),a.find("li").first().addClass("first-row"),a.find("li").last().addClass("last-row")})},$(document).on("click","#recentFilesList li a.delete-btn",function(){const e=$(this),t=e.attr("data-path");s.recentFiles.delete(t),e.parents("li").remove()});var p=!1;return n.hide=function(){p=!0,i.hide()},n}(),Sejda.SelectedFiles=function(){var e=[],t=!0;const n={};return n.addFiles=function(n){e=e.concat(n),e.length>n.length&&(t=!1)},n.getCount=function(){return e.length},n.getSummary=function(){const t=n.getCount();var o=t+" "+(t>1?"files":"file")+" selected";return 1===t&&(o="Selected: "+e[0].name.truncateMiddle(60)),o},n.reset=function(){e=[],t=!0},n.isFirstFileBatch=function(){return t},n}(),Sejda.RecentFiles.render(),$(document).on("filesSelected",function(e,o){try{var a=o.files;switch(Sejda.SelectedFiles.addFiles(a),Sejda.RecentFiles.hide(),a.sort(function(e,t){return naturalSort(e.name,t.name)}),Sejda.AppWindow.setTitleBasedOnFiles(a),P){case"splitByPages":case"extractPages":case"deletePages":case"pdfToJpg":case"pdfToImage":case"resizePages":d(a),t(a);break;case"alternateMix":case"merge":case"combineReorder":case"rotatePages":f(a);break;case"jpgToPdf":p(a);break;case"docToPdf":case"repair":case"htmlToPdf":case"ocr":case"pdfToDoc":case"pdfToExcel":t(a),B.hide();break;case"edit":case"fillSign":u(P);break;case"crop":case"splitByBookmarks":case"splitByText":case"watermark":t(a);break;default:n(t)(a,!0)}"true"===y.attr("data-auto-submit")&&setTimeout(function(){$("form.task-form button[type=submit]").click()},1e3)}catch(e){console.error("Render failed",e),Raven.captureException(e)}}),$(".fileupload,.image-fileupload,.attachment-fileupload").each(function(e,t){var n=$(t),o="true"===n.attr("data-allows-drop")?$(document):null,a="true"===n.attr("data-allows-paste")?$(document):null,i=n.attr("data-scope");n.attr("id")||n.attr("id","fileupload_"+uuidv4()),n.fileupload({dropZone:o,pasteZone:a,add:function(e,t){Sejda.Images.convertImages(t.files,i).catch(function(e){console.error(e),Raven.captureException(e)}).finally(function(){_.each(t.files,function(e){function t(){return e.path?Promise.resolve():e.arrayBuffer().then(function(t){var n=window.sejdaContext.node.fse.createTmpFile(e.name,t);e._path=n,e.path=n})}t().then(function(){e.scope=i,e.id=e._path||e.path,e.localId=e.localId||uuidv4(),e.uploadPromise=Sejda.FileUploadPromises.get(e.localId),$(document).trigger("fileUploadStarted",e),$(document).trigger("fileUploadDone",e)}).catch(function(e){Raven.captureException(e)})})})}})}),$(".fileupload").each(function(e,t){var n=$(t);n.bind("fileuploaddrop",function(e,t){Analytics.trackNoPushEvent("fileOpen","dragDrop",t.files.length,Date.now()),b(e,t,n)}),n.bind("fileuploadchange",function(e,t){Analytics.trackNoPushEvent("fileOpen","uploadBtn",t.files.length,Date.now()),b(e,t,n)})}),$(".image-fileupload,.attachment-fileupload").each(function(e,t){const n=$(t),o=n.hasClass("image-fileupload");n.bind("fileuploaddrop",function(e,t){Analytics.trackNoPushEvent("fileImageOpen","dragDrop",t.files.length,Date.now()),v(e,t,n)}),n.bind("fileuploadchange",function(e,t){Analytics.trackNoPushEvent("fileImageOpen","uploadBtn",t.files.length,Date.now()),v(e,t,n)}),o&&n.bind("fileuploadpaste",function(e,t){t&&t.files&&t.files.length>0&&(Analytics.trackNoPushEvent("fileImageOpen","paste",t.files.length,Date.now()),_.each(t.files,function(e){e.pasted=!0}),v(e,t,n))})}),$(".open-blank-doc-btn").click(function(){const e=window.sejdaContext.node.fse.currentDir(),t=window.sejdaContext.node.path.join(e,"views","public","assets","new_document.pdf"),n=[t];F(n)});var O=Sejda.SessionStorage.getItem("files");if(Sejda.SessionStorage.removeItem("files"),O){const I=JSON.parse(O);F(I)}}),$(document).on("click",".toggle-password",function(){var e=$(this);e.toggleClass("fa-eye fa-eye-slash");var t=e.siblings("[name=filePwd]");"password"===t.attr("type")?t.attr("type","text"):t.attr("type","password")});const ScanWarningPrompt=function(){const e=$("#task-content"),t={};var n=!1;return t.showOnce=function(){n||(n=!0,t.show())},t.show=function(t){const n=e.attr("data-task"),o=$("#scanPrompt");if(t&&t.file&&t.file.name&&o.find(".file-name").text(t.file.name.truncateMiddle(30)),"edit"!==n)o.find('[data-scope="edit"]').hide(),o.find('[data-scope="convert"]').show(),o.find(".dont-show-anymore-opts").hide();else{const a=Sejda.LocalStorage.getItem("scanPrompt.dontShowAnymore");if("true"===a)return!1}return o.find("input[type=checkbox][name=dontShowAnymore]").change(function(){Sejda.LocalStorage.setItem("scanPrompt.dontShowAnymore",this.checked)}),o.modal("show"),!0},t}();try{const requiredMbs=200,hasEnoughDisk=window.sejdaContext.node.fse.hasAvailableDiskSpace(requiredMbs);hasEnoughDisk||showModalAlert({title:s_i18n("Insufficient disk space"),msg:s_i18n("Your main disk is too full for the application to run properly.")+"\n"+s_i18n("Please free up some space and try again. Minimum required:")+" "+requiredMbs+" "+s_i18n("MB")})}catch(e){Raven.captureException(e)}$(function(){$(document).on("click",".image-delete-page",function(e){e.stopPropagation(),$(".tooltip").hide();var t=$(this).parents(".image-page-wrap");t.fadeOut(100,function(){t.remove()})})}),$(function(){$("#thumbsSizeInput").val(Sejda.Thumbs.getSize()),$(".clear-selection-btn").click(function(){$(document).trigger("select-none")})}),$(function(){const e="false"!==$("#task-content").attr("data-can-magnify");e&&($(document).on("click",".page-tools-magnify-btn",function(e){e.preventDefault(),e.stopPropagation(),$(".page-magnify-backdrop").remove();var t=$(this);const n=t.parents(".pdf-page-wrap"),o=n.find(".pdf-page, .image-page").cloneWithCanvas();if(o.removeAttr("style").removeAttr("data-rendered").addClass("page-magnified"),o.hasClass("pdf-page")){var a=parseInt(n.attr("data-page")),i=parseInt(n.attr("data-file-counter"));$(document).trigger("doRenderPage",{page:a,counter:i,target:o.get(0),desiredWidth:1e3})}const r=$('<div class="page-magnify-backdrop"><a id="closePagePreviewBtn" href="javascript://">&times;</a></div>');r.append(o),$("body").prepend(r)}),$(document).on("click","#closePagePreviewBtn",function(){$(".page-magnify-backdrop").remove()}),$(document).keyup(function(e){27===e.keyCode&&$(".page-magnify-backdrop").remove()}))}),$(function(){function e(e){return{page:e.attr("data-page"),file:e.attr("data-file-counter")}}function t(e,t){return(e+t+360)%360}var n=$("#task-content"),o="true"==n.attr("data-can-reorder"),a="true"==n.attr("data-can-delete"),i="true"==n.attr("data-can-bulk-delete"),r="true"==n.attr("data-can-rotate"),s="false"!=n.attr("data-can-select"),c="false"!=n.attr("data-can-select-multiple"),u="true"==n.attr("data-can-clear-selection"),l="true"===n.attr("data-single-click-select-multiple"),d="true"===n.attr("data-can-duplicate");const f="true"===n.attr("data-can-move");o?$(".can-reorder").show():$(".can-reorder").remove(),a?$(".can-delete").show():$(".can-delete").remove(),r?($(".can-rotate").show(),$(document).on("pagesRendered",function(e){$(".can-rotate").show()})):$(".can-rotate").remove(),s||$(".can-select").remove(),d&&$(document).on("click",".page-tools-duplicate-btn",function(e){e.stopPropagation(),$(".tooltip").hide();const t=$(this).parents(".pdf-page-wrap"),n=t.attr("id")+"_Duplicate"+Date.now();t.cloneWithCanvas().attr("id",n).insertAfter(t)}),f&&$(document).on("click",".page-tools-move-btn",function(e){e.stopPropagation(),$(".tooltip").hide();const t=$(this).parents(".pdf-page-wrap"),n=t.parents(".pdf-page-wrap-parent"),o=n.find(".pdf-page-wrap"),a=o.length,i=o.index(t)+1,r=$("#movePagePrompt"),s=r.find("#moveNewPageNumber");i>0&&s.val(i),r.off("shown.bs.modal").on("shown.bs.modal",function(){s.select().focus()});const c=r.find(".btn-yes");s.on("keydown",function(e){13===e.keyCode&&c.click()}),r.find(".num_of_pages").text("of "+a),c.off("click").on("click",function(e){const i=Number.parseInt(s.val());return Number.isNaN(i)||i<=0||i>a?void s.addClass("has-error"):(i>=a?t.appendTo(n):t.insertBefore(o.eq(i-1)),t.addClass("just-moved"),t[0].scrollIntoView({behavior:"smooth",block:"nearest"}),setTimeout(function(){t.css("backgroundColor","#fff8c0").animate({backgroundColor:"transparent"},1e3,function(){t.css("backgroundColor",""),setTimeout(function(){t.removeClass("just-moved")},3e3)})},700),void r.modal("hide"))}),r.modal("show")});var p=$(".can-select-multiple");if(c){if(navigator.platform.startsWith("Mac")){var g=p.text();p.text(g.replaceAllCaseInsensitive("Ctrl","Cmd"))}}else p.remove();if(u?$(".can-clear-selection").show():$(".can-clear-selection").remove(),$(document).on("keyup keydown",function(e){16===e.keyCode&&("keydown"===e.type?document.shifted=!0:document.shifted=!1),17===e.keyCode&&("keydown"===e.type?document.ctrled=!0:document.ctrled=!1)}),r&&$(document).on("click",".page-tools-rotate-btn",function(e){e.stopPropagation();const n=$(this),o=n.parents(".pdf-page-wrap"),a=o.find(".pdf-page, .image-page"),i=$(this).data("rotation")||90,r=parseInt(o.attr("data-rotation")||0),s=t(r,i);o.attr("data-rotation",s),a.removeClass("rotated-90").removeClass("rotated-180").removeClass("rotated-270").removeClass("rotated-0").addClass("rotated-"+s),$(document).trigger("pageRotated",{rotation:s,$page:a}),n.blur()}),s){var m=$("#pdf-canvas-list"),h=$("#pdf-canvas-list2");$(document).on("select-all",function(){m.find(".pdf-page-wrap").addClass("selected ui-multisort-grouped"),$(document).trigger("selectedPagesChanged")}),$(document).on("select-none",function(){m.find(".pdf-page-wrap").removeClass("selected ui-multisort-grouped"),h.find(".pdf-page-wrap").removeClass("selected ui-multisort-grouped"),$(document).trigger("selectedPagesChanged")}),$(document).on("select-odd",function(){m.find(".pdf-page-wrap").each(function(e){e%2===0?$(this).addClass("selected ui-multisort-grouped"):$(this).removeClass("selected ui-multisort-grouped")}),$(document).trigger("selectedPagesChanged")}),$(document).on("select-even",function(){m.find(".pdf-page-wrap").each(function(e){e%2===1?$(this).addClass("selected ui-multisort-grouped"):$(this).removeClass("selected ui-multisort-grouped")}),$(document).trigger("selectedPagesChanged")}),$(document).on("select-inverse",function(){m.find(".pdf-page-wrap").each(function(){var e=$(this);e.hasClass("selected")?e.removeClass("selected ui-multisort-grouped"):e.addClass("selected ui-multisort-grouped")}),$(document).trigger("selectedPagesChanged")});var w;$(document).on("click",".pdf-page-wrap",function(t){var n=$(this),o=n.hasClass("selected"),a=e(n);const i="false"!==n.parents(".pdf-page-wrap-parent").attr("data-can-select-pages");if(i){document.ctrled||document.shifted||t.metaKey||l!==!0&&n.parents(".pdf-page-wrap-parent").find(".pdf-page-wrap.selected").removeClass("selected ui-multisort-grouped"),o?n.removeClass("selected ui-multisort-grouped"):n.addClass("selected ui-multisort-grouped");var r=n.parents(".pdf-page-wrap-parent");if(document.shifted&&w&&c){var s,u,d=w,f=0!==d.nextAll().filter(n).length;do s=f?d.next(".pdf-page-wrap"):d.prev(".pdf-page-wrap"),s.addClass("selected").addClass("ui-multisort-grouped"),d=s,u=s.length>0&&(e(s).page!=a.page||e(s).file!=a.file);while(u)}r.attr("data-prev-selected-page",a.page).attr("data-prev-selected-file",a.file),w=n,$(document).trigger("selectedPagesChanged")}})}$(document).on("selectedPagesChangedInput",function(e,t){var n=t.pages||[];$(".pdf-page-wrap").removeClass("selected"),_.each(n,function(e){$("#pdfPageWrap"+e).addClass("selected")})}),$(document).on("selectedPagesChanged",function(){var e=[];$(".pdf-page-wrap.selected").each(function(t,n){e.push(parseInt($(n).attr("data-page")))});var t="splitByPages"!=$("#task-content").attr("data-task"),n=e.join(",");if(t){for(var o,a,i=[],r=0;r<e.length;r++){var s=e[r];a?s==a+1?a=s:(o==a?i.push(o):i.push(o+"-"+a),a=o=s):a=o=s}o==a?i.push(o):i.push(o+"-"+a),n=i.join(",")}$("#specificPages").val(n),$(".specific-pages-selector").siblings("label.btn").removeClass("active"),$(".specific-pages-selector").click(),$("#specificPagesWrap").show()}),a&&($(document).on("pdfPagesDeleted",function(){const e=$("#pdf-canvas-list"),t=e.find(".pdf-page-wrap").length;0===t&&e.find(".empty").show()}),$(document).on("click",".page-tools-delete-btn,.pdf-delete-page-xl",function(e){e.stopPropagation(),$(".tooltip").hide();var t=$(this).parents(".pdf-page-wrap"),n=parseInt(t.attr("data-page"));const o=t.parents(".pdf-page-wrap-parent");var a=o.find(".pdf-page-wrap.selected").not(t),r=a.map(function(){return parseInt($(this).attr("data-page"))}).toArray();if(i)t.fadeOut(100,function(){t.remove(),a.remove(),$(document).trigger("pdfPagesDeleted",{pages:r.concat([n])})});else if(t.fadeOut(100,function(){t.remove(),$(document).trigger("pdfPagesDeleted",{pages:[n]})}),a.length>1){var s=$("#deletePagesModal");s.find(".num").text(a.length),s.find(".btn-yes").off("click").on("click",function(){a.each(function(e,t){$(t).fadeOut(100,function(){$(t).remove()})}),setTimeout(function(){$(document).trigger("pdfPagesDeleted",{pages:r})},300)}),s.modal("show")}})),o&&$(document).on("pagesRendered",function(e,t){const n=t.$elem;n.parents("#pagesPickerModal").length>0||(n.find(".pdf-page-wrap").addClass("grabbable"),n.multisortable("instance")&&n.multisortable("destroy"),n.multisortable({items:"> .grabbable",scroll:!0,scrollSensitivity:100,receive:function(e,t){n.find(".empty").hide(),setTimeout(function(){$(document).trigger("renderVisiblePageThumbs")},1e3)},start:function(e,t){if(t.item.hasClass("ui-multisort-grouped")){var o=n.find(".ui-multisort-grouped");o.addClass("dragged").find(".magnified").hide(),o.each(function(e){$(this).attr("data-sort",e)})}else t.item.addClass("dragged").find(".magnified").hide()},stop:function(e,t){if(t.item.removeClass("dragged"),t.item.hasClass("ui-multisort-grouped")){var o=n.find(".ui-multisort-grouped");o.removeClass("dragged");var a=o.not(t.item);a.cloneWithCanvas().insertBefore($(t.item)),a.each(function(){$(this).removeClass("ui-multisort-grouped")}),a.remove();var i=$(n.find(".ui-multisort-grouped").get().reverse());i.each(function(){for(var e=$(this),t=parseInt(e.attr("data-sort")),n=e.prev(".ui-multisort-grouped"),o=parseInt(n.attr("data-sort"));t<o;)e.detach().insertBefore(n),n=e.prev(".ui-multisort-grouped"),o=parseInt(n.attr("data-sort"))}),$(document).trigger("pdfPagesReordered")}}}),n.disableSelection())}),$(document).on("click",".page-section-quick-action",function(){const e=$(this).attr("data-action");$(document).trigger(e)})}),$(function(){function e(e){const t=e/150;$(".pdf-page, .pdf-page-number, .image-page").css("width",e+"px").css("max-height",Math.round(210*t)+"px"),Sejda.Thumbs.setSize(e),$(document).trigger("thumbSizeChanged",{width:e}),e<150?$("body").addClass("page-thumbs-xs"):$("body").removeClass("page-thumbs-xs"),e>350?$("body").addClass("page-thumbs-xl"):$("body").removeClass("page-thumbs-xl")}Sejda.Browsers.isMobile?$(document).trigger("thumbSizeChange",{size:100}):e(Sejda.Thumbs.getSize()),$("#thumbsSizeInput").on("input change",function(t){e(this.value)}),$(document).on("thumbSizeChange",function(t,n){n.size&&e(n.size)}),$(".thumbs-size-panel .fal").click(function(e){e.preventDefault();const t=$(this),n=$("#thumbsSizeInput");var o=parseInt(n.val());t.hasClass("increase")?o+=10:o-=10,n.val(o).trigger("change")}),$(".thumbs-size-panel [title]").tooltip(tooltipOpts)}),$(function(){const e=$(".can-toggle-view-mode");e.find(".btn").click(function(){const e=$(this).find("input").val();$("body").attr("data-view-mode",e),$(document).trigger("changedViewMode",{mode:e})})}),$(function(){var e=$("#addMoreFilesUploadForm"),t=e.attrOr("data-filetypes","").split(",");e.find(".fileupload").attr("accept",_.map(t,function(e){return"."+e}))}),$(function(){$(document).on("focus","form input",function(e){var t=$(this).attr("name");$('.input-helper[data-for="'+t+'"]').fadeIn()}),$(document).on("click","#taskResultModal .close",function(){var e=$("form.task-form").find('[type="submit"]');e.find(".fa-spinner").remove(),e.removeAttr("disabled").find(".fa-spinner").remove(),window.runningTask&&window.runningTask.cancel&&window.runningTask.cancel()}),window.sejdaContext.general.webContents.on("before-quit",function(){window.runningTask&&window.runningTask.cancel&&window.runningTask.cancel()})}),$(function(){$('[data-toggle="tooltip"]').tooltip(tooltipOpts)}),$("html, body").animate({scrollTop:0},10),window.TaskCommonOutputInitOpts&&Sejda.TaskCommonOutput.init(window.TaskCommonOutputInitOpts),$(function(){function e(){o.hide(),a.hide(),$(document).trigger("moreOptionsHidden")}function t(){o.show(),a.show(),$(document).trigger("moreOptionsShown"),"batesNumbering"!==i&&"headerFooter"!==i&&"merge"!==i||$("button[type=submit]").scrollHere()}function n(){o.is(":visible")||a.is(":visible")?e():t()}const o=$(".more-options"),a=$(".more-options-item"),i=task();$(".btn-more-options").click(function(){n()}),$(document).on("hideMoreOptions",function(){e()})});var Files={},Files2=function(){function e(e){s.push(e)}function t(e){return _.find(s,function(t){return t.id===e})}function n(e){return _.find(s,function(t){return t.counter===e})}function o(e){var t=n(parseInt(e));return t?t.id:void 0}function a(e){if(e.length<=1)return e;var n=_.map(e,function(e){return t(e)});return n=n.sort(function(e,t){return naturalSort(e.name,t.name)}),_.map(n,function(e){return e.id})}function i(){return _.map(s,function(e){return"["+e.id+","+e.counter+","+e.name+"]"}).join(",")}function r(){s=[]}var s=[];return{add:e,byId:t,idByCounter:o,naturalSorted:a,debug:i,clear:r}}(),Sejda=window.Sejda||{};Sejda.ReorderFilesModal=function(){var e={},t=$(".task-form"),n=$("#reorderFilesList"),o=$("#reorderFilesPrompt");return e.showModal=function(){function e(e){return $(e.elm).attr("data-filename-raw").toLowerCase()}function a(e){return parseInt($(e.elm).attr("data-lastmod")||"0")}n.find("li").remove();var i=t.find('[name="files[]"]').toArray();o.find(".modal-title").text(i.length+" files selected - Drag to reorder"),i.forEach(function(e){var t=$(e).val(),o=Files2.byId(t),a=$('<li><i class="fal fa-file"></i><span class="filename"></span></li>');a.find(".filename").text(o.name.truncateMiddle(60)),a.attr("data-id",t),a.attr("data-filename-raw",o.name),a.attr("data-lastmod",o.lastModified),n.append(a)}),t.find('[name="filesNaturalSorted"]').remove(),t.append('<input type="hidden" name="filesNaturalSorted" value="false">'),n.sortable(),n.on("sortupdate",function(){n.find("li").each(function(){var e=$(this),n=e.attr("data-id");t.find('[name="files[]"][value="'+n+'"]').remove(),t.append('<input type="hidden" name="files[]" value="'+n+'">')})}),o.find(".sort-btn").off("click").click(function(){const t=$(this).attr("data-sort-order").split("-"),o=t[1];var i=function(t,n){return naturalSort(e(t),e(n))};"lastmod"===t[0]&&(i=function(e,t){const n=a(e),o=a(t);return n===o?0:n<o?-1:1}),tinysort("#reorderFilesList>li",{order:o,sortFunction:i}),n.trigger("sortupdate")}),o.modal("show")},$(document).on("click","#pdf-files-summary-wrap.multiple span",function(){e.showModal()}),e}(),Sejda.WaitCountdownClock=function(){function e(e){return("0"+e).slice(-2)}var t=0,n=0;return this.start=function(o,a){function i(){var n=Math.max(0,Math.round((t-Date.now())/1e3)),o=Math.floor(n/3600),a=Math.floor((n-3600*o)/60),i=n-3600*o-60*a;return r.text([e(o),e(a),e(i)].join(":")),n}var r=$(".wait-countdown-clock");clearInterval(n),t=Date.now()+1e3*Math.round(parseInt(o)),i(),n=setInterval(function(){var e=i();e<=0&&(a(),clearInterval(n))},1e3)},this}(),$(function(){function e(e,t){e.find(".upgrade-reason").hide(),e.find("#"+t+"-reason").show(),e.show()}function t(e){var t=new Error(e);return t.alertable=!0,t}const n=window.sejdaContext.general.prefs,o=window.sejdaContext.node.fse,a=window.sejdaContext.node.path,i=window.sejdaContext.general.utils.Crypto,r="linux"!==window.sejdaContext.node.process.platform();$(document).on("fileUploadDone",function(e,t){"task-file"==t.scope&&($(".task-form").append('<input type="hidden" name="files[]" value="'+t.id+'">'),Files[t.counter]=t.id,Files2.add(t))}),$(document).on("fileUploadFailed",function(e,t){$('[data-file-counter="'+t.counter+'"]').remove(),setTimeout(function(){$('[data-file-counter="'+t.counter+'"]').remove()},2e3)}),$(document).on("filePassword",function(e,t){var n=t.file;$(".task-form").find('input[name="files[]"]').each(function(){0==$(this).val().indexOf(n.id)&&$(this).remove()});var o=i.random(32),a="G'SRta^_l2MSH}Hl.Kf\"No.*:.XBMY",r=n.id+"||"+i.encrypt(t.password,a,o)+"||"+o;$(".task-form").append('<input type="hidden" name="files[]" value="'+r+'">'),Files[n.counter]=r}),$("form.task-form").submit(function(i){function s(){function i(){return new Promise(function(e,o){if(!g.files||!g.files.length)return o(t(s_i18n("No files selected.")));if("splitByPages"==g.type){if(g.step=$("#splitStep").val(),""==g.pages)return o(t(s_i18n("Please select pages to split.")));g.specificResultFilenames=[],$(".cut-mark.selected").each(function(){var e=$(this).prev(".pdf-page-wrap").attr("data-result-filename")||"";g.specificResultFilenames.push(e)})}if("merge"===g.type)if("file"===g.mode){if(g.files=[],g.images=[],g.rotations=[],$("#pdf-canvas-list2").find(".pdf-page-wrap").each(function(e,t){const n=$(this),o=Files[parseInt(n.attr("data-file-counter"))];g.files[e]=o,g.rotations[e]=$(this).attr("data-rotation")||0;const a=n.attr("data-filename");a.toLowerCase().endsWith(".pdf")||g.images.push(o)}),g.files=_.filter(g.files,function(e){return null!=e}),0===g.files.length)return o(t(s_i18n("No files selected.")));
}else if("page"===g.mode){g.type="combineReorder",g.images=[],g.files.forEach(function(e){e.split("||")[0].toLowerCase().endsWith(".pdf")||g.images.push(e)}),g.filePages=[];var a={};if($("#pdf-canvas-list").find(".pdf-page-wrap").each(function(e,t){var n=parseInt($(this).attr("data-file-counter")),o=$(this).attr("data-filename"),i=$(t),r=Files[n],s=g.files.indexOf(r),c=i.attr("data-page"),u=i.attr("data-rotation")||0;if("blank_page"===o)g.filePages[e]="-1:-1:"+u;else if(s>=0&&"undefined"!=typeof c){if(a[s+":"+c]){const l=g.files.push(r)-1;console.log("Duplicate page detected, avoiding input reuse:",s+":"+c," ->",l+":"+c),s=l}g.filePages[e]=s+":"+c+":"+u,a[s+":"+c]=!0}else console.error("Pages missing:",o,c,s,n)}),0===g.filePages.length)return o(t(s_i18n("No pages found")))}if("alternateMix"===g.type&&(g.files=[],g.step=[],g.reverse=[],g.repeat=[],$(".pdf-file-item").each(function(e,t){var n=$(this);g.files[e]=Files[parseInt(n.attr("data-file-counter"))],g.reverse[e]="true"===n.find('.active [name="reverse"]').val(),g.step[e]=n.find('[name="step[]"]').val(),g.repeat[e]="true"===n.attr("data-repeat")}),g.files.length<2))return o(t(s_i18n("Need at least 2 files in order to alternate & mix them.")));if("extractPages"==g.type&&$(".predefined-pages-selector.active").each(function(e,t){g.pages=$(this).find("input[type=radio]").val()}),"combineReorder"==g.type){g.filePages=[];var a={};if($("#pdf-canvas-list").find(".pdf-page-wrap").each(function(e,t){var n=parseInt($(this).attr("data-file-counter")),o=$(this).attr("data-filename"),i=Files[n],r=g.files.indexOf(i),s=$(t).attr("data-page"),c=$(t).attr("data-rotation")||0;if("blank_page"===o)g.filePages[e]="-1:-1:"+c;else if(r>=0&&"undefined"!=typeof s){if(a[r+":"+s]){const u=g.files.push(i)-1;console.log("Duplicate page detected, avoiding input reuse:",r+":"+s," ->",u+":"+s),r=u}g.filePages[e]=r+":"+s+":"+c,a[r+":"+s]=!0}else console.error("Pages missing:",o,s,r,n)}),0==g.filePages.length)return o(t(s_i18n("No pages. Please add at least one page.")))}if("splitByBookmarks"==g.type&&$("#bookmarksLevelSelector").find(".active input").each(function(e,t){g.bookmarksLevel=$(t).val()}),"splitByText"==g.type&&""==g.area.x)return o(t(s_i18n("No text area selected. Drag and drop on the page to select text by which to split.")));if("rotatePages"==g.type&&(g.pageRotationsPerSource=[],$(".pdf-page-wrap[data-rotation]").each(function(e,t){const n=parseInt($(this).attr("data-file-counter")),o=g.files.indexOf(Files[n]),a=$(t),i=parseInt(a.attr("data-page")),r=parseInt(a.attr("data-rotation"));0!==r&&g.pageRotationsPerSource.push(o+":"+i+":"+r)}),0===g.pageRotationsPerSource.length))return o(t(s_i18n("Please select pages to rotate")));if("crop"===g.type&&g.autoCropMode&&"none"===g.autoCropMode){var i=JSON.tryParse($("#wrap0").attr("data-area")),r=JSON.tryParse($("#wrap00").attr("data-area"));if(r&&i&&r.top&&i.top?(g.oddArea=i,g.evenArea=r):i&&i.top?g.area=i:$(".page-wrap").each(function(){if("wrap0"!==this.id){var e=$(this),t=parseInt(e.attr("data-page-num")),n=JSON.tryParse($(this).attr("data-area"));n&&n.top&&!Number.isNaN(t)&&(g.pageAreas=g.pageAreas||{},g.pageAreas[t]=n)}}),!(i&&0!==i.length||g.pageAreas&&0!==g.pageAreas.length))return o(t(s_i18n("Please select area to crop.")))}if("edit"!==g.type&&"fillSign"!==g.type||(_.each(["appendTextOperations","editTextOperations","imageOperations","shapeOperations","insertPageOperations","deletePageOperations","highlightTextOperations","editHighlightOperations","deleteHighlightOperations","appendLinkOperations","editLinkOperations","deleteLinkOperations","appendAttachmentOperations","deleteAttachmentOperations","appendEmbeddedFileOperations","deleteEmbeddedFileOperations","formValues","appendFormFieldOperations","deleteFormFieldOperations","appendDraw","appendLine","deleteImageOperations","formWidgets"],function(e){g[e]=_.map(g[e],function(e){return JSON.parse(e)})}),g.formValues=g.formValues[0],g.formWidgets=g.formWidgets[0],g.files=g.files.filter(function(e){return e.split("||")[0].toLowerCase().endsWith(".pdf")})),"watermark"==g.type){var s=JSON.parse(g.jsonData);delete g.jsonData,_.extend(g,s)}if("pdfToExcel"==g.type){_.each(["tables"],function(e){g[e]=_.map(g[e],function(e){return JSON.parse(e)})});var u=g.tables;if(!u||0==u.length)return o(t(s_i18n("No table data was detected in the PDF document.")))}if("jpgToPdf"==g.type){g.files=[],g.rotations=[],$(".pdf-page-wrap").each(function(e,t){var n=$(this);g.files[e]=Files[parseInt(n.attr("data-file-counter"))],g.rotations[e]=n.attr("data-rotation")||0}),g.mergeOutputs=!0;try{c.find("input[name=mergeOutputs]").get(0).checked===!1&&(g.mergeOutputs=!1)}catch(e){}if("custom"===g.pageSize){const l=$("#pageSizeCustomOption");g.pageSizeCustomWidth=parseFloat(l.attr("data-w")),g.pageSizeCustomHeight=parseFloat(l.attr("data-h"))}if(0==g.files.length)return o(t(s_i18n("No images selected to convert.")))}if("encrypt"===g.type&&(g.userPassword=$("#userPassword").val(),g.ownerPassword=$("#ownerPassword").val()),"editMetadata"==g.type){var d={};Object.keys(g).forEach(function(e){e.startsWith("metadata.")&&delete g[e]}),c.find("input[type=text]").each(function(e,t){var n=$(t);if(!n.parents(".form-group").hasClass("collapsed")){var o=n.attr("name"),a=n.val()||"";if(o.startsWith("metadata.")){var i=o.substring(9);d[i]=a}}});for(var f=Object.entries(d),p=0;p<f.length;p++){var m=f[p][0],h=f[p][1];if(("CreationDate"===m||"ModDate"===m)&&h){var w=!0;10===h.length&&(h+=", 00:00:00",d[m]=h),20!==h.length&&(w=!1),"/"!==h.substr(2,1)&&"/"!==h.substr(4,1)&&(w=!1),","!==h.substr(10,1)&&" "!==h.substr(11,1)&&(w=!1),":"!==h.substr(16,1)&&":"!==h.substr(17,1)&&(w=!1);var v=h.substr(0,2),b=h.substr(3,2),F=h.substr(6,4),C=h.substr(12,2),y=h.substr(15,2),k=h.substr(18,2),S=F+"-"+b+"-"+v+"T"+C+":"+y+":"+k,A=new Date(S);if(A&&!isNaN(A.getTime())||(w=!1),w===!1)return o(t("Invalid field: "+m+". Use format: 13/04/2021, 23:53:41"));d[m]=A.getTime()}}g.metadata=d}if("renameByText"===g.type){if(g.areas=JSON.tryParse(g.areas),0===g.areas.length)return o(t(s_i18n("No text areas have been defined")));if(0===g.renamePattern.trim().length)return o(t(s_i18n("Rename pattern is missing")))}if("editBookmarks"===g.type){var s=JSON.parse(g.jsonData);delete g.jsonData,_.extend(g,s)}var x=n.get();g.key=x.licenseKey,g.token=x.licenseToken,e()})}function s(){return new Promise(function(e,t){if("edit"===g.type||"fillSign"===g.type){var n=[];if(g.editTextOperations.forEach(function(e){n.push(e.font)}),g.appendTextOperations.forEach(function(e){n.push(e.font)}),n=_.uniq(n),window.SystemFonts)return SystemFonts.getAvailableFonts(function(t){var o=[];n.forEach(function(e){var n=t.byFamily[e];n&&(o=o.concat(n))}),g.systemFonts=o,e()})}else if("ocr"===g.type&&r){const o=g.lang||"eng",a=window.sejdaContext.general.tesseract.requiresLangDownload(o);if(a)return console.log("OCR language",o,"needs to be downloaded first"),fetch(a,{method:"GET"}).then(function(e){return console.log("OCR language",o,"downloaded"),e.arrayBuffer()}).then(function(t){window.sejdaContext.general.tesseract.saveLangDownload(o,t),console.log("OCR language",o,"saved"),e()}).catch(function(e){console.error("Failed to download OCR language",o),console.error(e)});console.log("OCR language:",o,"does not require download")}e()})}function l(){return new Promise(function(e,t){function n(){return t(new Error("Cancelled output file prompt"))}function o(t,n,o,r){t=t.replaceAllEscaped("\\\\?\\",""),g.outputFilenamePattern=r;var s=g.type;if(("edit"===s||"fillSign"===s)&&t===g.files[0]){var c=a.basename(t);return alert(s_i18n("Cannot overwrite")+' "'+c+'".\n'+s_i18n("Please choose another save location.")),i()}return n?g.defaultOutputFolder=t:g.defaultOutputFile=t,g.existingOutputPolicy=o,e()}function i(){Sejda.TaskCommonOutput.promptForOutputLocation(o,n)}"watermark"===g.type?g.files&&g.files.length>1||g.watermarks&&g.watermarks.length>1?Sejda.TaskCommonOutput.switchOutputToDirectory():Sejda.TaskCommonOutput.switchOutputToFile():"pdfToExcelNext"===g.type?g.files&&g.files.length>1||"csv"===g.exportFormat?Sejda.TaskCommonOutput.switchOutputToDirectory():Sejda.TaskCommonOutput.switchOutputToFile():"jpgToPdf"===g.type&&(g.mergeOutputs===!1&&g.files.length>1?Sejda.TaskCommonOutput.switchOutputToDirectory():Sejda.TaskCommonOutput.switchOutputToFile()),i()})}function d(){return new Promise(function(e,n){if(g.defaultOutputFile){var i=a.resolve(g.defaultOutputFile,"..");if(!o.isFolderWritable(i))return n(t(s_i18n("Cannot write to")+" "+i+". "+s_i18n("Please choose another save location.")))}else if(g.defaultOutputFolder&&!o.isFolderWritable(g.defaultOutputFolder))return n(t(s_i18n("Cannot write to")+" "+g.defaultOutputFolder+". "+s_i18n("Please choose another save location.")));e()})}function f(){$("#taskResultModal").find(".close").click()}function p(){function t(t,n,o){if(n){var a=s.find(".upgrade.states");a.show();var i=a.find(".upgrade-section");if(e(i,n.reason),"tasks-per-hour"==n.reason){var r=n.untilResetSeconds;Sejda.WaitCountdownClock.start(r,function(){Sejda.LocalStorage.removeItem("upgrade.tasks-per-hour.waitUntilDate")});var c=Date.now()+1e3*r;Sejda.LocalStorage.setItem("upgrade.tasks-per-hour.waitUntilDate",c)}}else{const u=$("#failureReason");if(u.text(t||""),o&&(u.append(" "),u.append($("<a>"+s_i18n("Learn more")+"</a>").attr("href","https://www.sejda.com"+o))),s.find(".failed").show(),$(".bug-report-btn").hide(),$(".close-frame-btn").off("click").click(function(e){e.preventDefault(),f()}),t||($(".bug-report-btn").show(),setTimeout(function(){Sejda.Desktop.ContactForm.submitBugReport().then(function(e){e&&$("#failureReason").html(Sejda.Utils.sanitizeHTMLAllowTags(e))})},300)),t&&"Could not crop automatically"===t)try{window.parent.couldNotCropAutomaticallyFromResultsFrame(function(){f()})}catch(e){}}}function n(){$(".top-alert.alert-info").remove(),u.find(".fa-spinner").remove(),u.removeAttr("disabled").find(".fa-spinner").remove(),s.find(".processing,.failed,.completed,.upgrade").hide()}function i(e){return{name:e.name,message:e.message,stack:e.stack,code:e.code}}var s=$("#taskResultModal");s.modal(),s.find(".failed,.completed,.upgrade").hide(),s.find(".processing").show();const c=window.sejdaContext.general.desktopLauncher;try{window.runningTask=c.execute(g,function(e,c){function u(e){W.css("opacity","0.5"),e.css("opacity","1")}function l(){W.css("opacity","1")}function d(e){return void 0!=e.attr("disabled")}function p(){var e=$(this);d(e)||u(e)}function m(){var e=$(this);e.attr("id");d(e)||l()}function h(e){var t=$("#"+e+"-panel");0!=t.length&&($(".lower-section").hide(),$(".result-btn-panel").hide(),t.show(),$("#buttonPanelsNav").show())}if(c=c||{},100===c.exitCode)return void console.log("Cancelled task completed",c);if(n(),window.lastTask=c,window.lastFormData=g,e){window.lastTask.clientErr=i(e),console.log(e),"undefined"!=typeof c.stderr&&console.error(c.stderr),"undefined"!=typeof c.stdout&&console.error(c.stdout),"undefined"!=typeof c.exitCode&&console.error(c.exitCode);var w,v,b;c.result&&(w=c.result.failureReason,v=c.result.upgrade);try{if(!w){var F=(c.stderr||"")+(c.stdout||"");if(F.includes("Error occurred during initialization of VM")&&(F.includes("Could not reserve")||F.includes("Failed to reserve")||F.includes("Failed to allocate"))||F.includes("There is insufficient memory for the Java Runtime Environment to continue"))w=s_i18n("Not enough free memory on the system");else if(F.includes("No space left on device")||F.includes("not enough space on the disk"))w=s_i18n("Disk is full");else if(e&&"JAVACMD_MISSING"===e.code)w=s_i18n("Installation seems corrupted. Please try reinstalling the program.");else if(e&&("EPERM"===e.code||"EACCES"===e.code||"spawn EPERM"===e.message)||5===c.exitCode)w=s_i18n("Permissions or antivirus problem."),b="/help#desktop-eperm-error";else if(e&&("ENOSPC"===e.code||e.message.includes("ENOSPC: ")))w=s_i18n("Disk is full");else if(e&&e.knownFailureReason)w=e.knownFailureReason;else if(100===c.exitCode)w="Task cancelled";else if(255===c.exitCode&&F.includes("Not enough memory resources are available"))w=s_i18n("Not enough free memory on the system");else if(99===c.exitCode)w=s_i18n("Please check the date & time on your system");else if("ocr"===g.type)r||(F.includes("Tesseract couldn't load any languages")?(w=s_i18n("OCR language data is missing."),b="/help#install-linux-ocr-language-data"):F.includes("Cannot run program")&&F.includes("error=2")&&(w=s_i18n("OCR engine is missing."),b="/help#install-linux-ocr-engine"));else if(F.includes("Error: could not find java.dll")&&F.includes("Error: Could not find Java SE Runtime Environment"))w=s_i18n('Please reinstall the app to "C:\\Program Files"');else{const C=F.split("\n");C.some(function(e){return e.includes("java.io.FileNotFoundException")&&e.includes("\\task.out (")})&&(w=s_i18n("Permissions problem or your antivirus causing issues"),b="/help#desktop-eperm-error")}}}catch(e){}return t(w,v,b)}s.find(".completed").show(),Sejda.UnsavedWork.clearUnsavedWork();var y=c.result.warnings;if(y&&y.length>0){var k=_.map(y,function(e){return"<p>"+Sejda.Utils.sanitizeHTML(e)+"</p>"}).join("");$("#result-warnings").html(k),$("#result-warnings-wrap").show()}else $("#result-warnings-wrap").hide();var S=c.result.result.toLowerCase().endsWith(".pdf"),A=o.isFolder(c.result.result);s.find("#open-btn,.open-folder-btn").off("click").on("click",function(e){window.sejdaContext.general.osHelper.open(c.result.result)});var x=s.find("#view-pdf-btn"),E=s.find("#print-pdf-btn");c.result.remark&&$("h2.remark").text(c.result.remark).show();var P,D=c.result.resultItems;S?P=c.result.result:D&&1===D.length&&D[0].toLowerCase().endsWith(".pdf")&&(P=D[0]),x.hide(),E.hide();var j=$("#preview-pdf"),B=$("#preview-folder"),O=$("#preview-file-other");if(j.hide(),B.hide(),O.hide(),P){x.show().off("click").on("click",function(){Sejda.Viewer.open(P)}),E.show().off("click").on("click",function(){const e=$("#viewerFrame").get(0);return e?void e.contentDocument.dispatchEvent(new KeyboardEvent("keydown",{key:"p",keyCode:80,which:80,ctrlKey:!0,metaKey:!0})):void I.trigger("click")});var I=$("#open-preview-btn"),T=$("#close-preview-btn");I.off("click").click(function(){j.find("iframe").remove();var e=$('<iframe id="viewerFrame" frameBorder="0" src=""></iframe>');j.append(e),Sejda.Viewer.show($("#viewerFrame"),P),j.show(),I.hide(),T.show(),Sejda.LocalStorage.setItem("results.autoShowPreview","true")}),T.off("click").click(function(){Sejda.LocalStorage.setItem("results.autoShowPreview","false"),j.hide(),I.show(),T.hide()});var N=!0;"false"===Sejda.LocalStorage.getItem("results.autoShowPreview")&&(N=!1),N&&I.click()}else if(A){var R=c.result.resultItems.length,L=1===R?"1 "+s_i18n("file produced"):R+" "+s_i18n("files produced");B.find(".resultItemCaption").text(L),B.show(),$(".preview-top-bar").hide()}else{var M=a.basename(c.result.result);O.find(".resultItemCaption").text(M),O.show(),$(".preview-top-bar").hide()}$(".continue-with-nav a,a.continue-with-btn").off("click").click(function(e){e.preventDefault();var t=$(this).attr("href"),n=c.result.resultItems;n.sort(),Sejda.SessionStorage.setItem("files",JSON.stringify(n)),window.top.location.href=t}),$(".result-btn,.filename-btn").tooltip(tooltipOpts);var W=$(".result-btn");W.off("hover").hover(p,m),W.click(function(){var e=$(this),t=e.attr("id");h(t)}),$("#backToAllActionsBtn").off("click").click(function(){$(".lower-section").show(),$(".buttons-section").show(),$(".result-btn-panel").hide(),$("#buttonPanelsNav").hide()});const U=window.location.pathname.split("/").slice(-1)[0],z=$("#continue-with-btn-panel").find('li a[href="./'+U+'"]').text()||"editing";$("#backToEditingTaskName").text(z),$(".close-frame-btn").off("click").click(function(e){e.preventDefault(),f()}),$("#startNewBtn").off("click").click(function(e){var t=window.top.location.protocol+"//"+window.top.location.hostname+window.top.location.pathname;window.top.location.href=t}),$(document).trigger("taskProcessingCompleted");const H=c.result.quotaUpdate;if(H){const V=H.remainingRequests;if(V){const J=Math.floor(parseInt(H.untilResetSeconds)/60);$(document).trigger("quota-updates",{remaining:V,waitMinutes:J})}}D&&1===D.length&&Sejda.RecentFiles.add(D[0],"result")})}catch(e){return console.log("Executing cli failed",e),window.lastTask={},window.lastFormData=g,window.lastTask.clientErr=i(e),n(),t()}}var g=c.serializeJSON({parseAll:!0});i().then(s).then(function(){return l()}).then(function(){return d()}).then(function(){p()}).catch(function(e){e&&(console.error(e),e.alertable&&showAlert(e.message)),u.removeAttr("disabled").find(".fa-spinner").remove()})}i.preventDefault();var c=$(this),u=c.find('[type="submit"]'),l=($("#task-content").attr("data-task"),runFormValidators($(document)));return l?(u.attr("disabled","disabled"),u.prepend('<i class="fal fa-spinner fa-spin"></i>'),void s()):void showAlert(s_i18n("Not all inputs are valid (see below). Please correct values and try again."),"danger")});var s=["CURRENTPAGE]","BASENAME]","TIMESTAMP]","FILENUMBER]","BOOKMARK_NAME]","BOOKMARK_NAME_STRICT]","TEXT]"];$(document).find('input[type=text][name="outputFilenamePattern"]').mention({emptyQuery:!0,delimiter:"[",users:_.map(s,function(e){return{username:e}})}),$("#start-new-btn,.start-new-btn").click(function(){window.location.reload()}),$(".upgrade-section .upgrade-btn").click(function(){Screens.showEnterLicenseKey()});var c=parseInt(Sejda.LocalStorage.getItem("upgrade.tasks-per-hour.waitUntilDate")||0),u=Math.round((c-Date.now())/1e3);if(u>0){var l=$("#top-upgrade-section-wrap").find(".upgrade-section");e(l,"tasks-per-hour"),Sejda.WaitCountdownClock.start(u,function(){Sejda.LocalStorage.removeItem("upgrade.tasks-per-hour.waitUntilDate")})}}),$(function(){const e=window.sejdaContext.general.prefs,t=e.get(),n=t.licenseKey;var o=$("#contactForm"),a=$("#contactFormModal"),i=$("#contact-msg"),r=$("#contactSuccess"),s=$("#bugReportResponseMessage");Sejda.Desktop.ContactForm=function(){var e={};return e.submitBugReport=function(){if("true"==t.autoReportErrors){console.log("Sending bug report...");var n=o.serializeJSON();return n.autoReport="true",n.about="Sejda PDF Desktop automated bug report",n.autoReportVersion="3",n.suflet="realitate",n.allowAccessLastTask="true",new Promise(function(t,o){e.submit(n).done(function(e){e=e||{},t(e.bugReportResponse)})})}return Promise.resolve()},e.submit=function(e){var t={licenseKey:n};if("true"==e.allowAccessLastTask){try{var o=window.lastFormData;if(o.files&&o.files.length>0)for(var a=0;a<o.files.length;a++){var i=o.files[a].indexOf("||");i>0&&(o.files[a]=o.files[a].substring(0,i)+"||pwd")}}catch(e){}if(t={task:window.lastTask,formData:window.lastFormData,userAgent:navigator.userAgent,installPath:window.sejdaContext.node.__dirname,currentScreen:window.location.pathname.substring(window.location.pathname.lastIndexOf("/")+1),taskResultsVisible:$("#taskResultModal").is(":visible"),licenseKey:n,events:Analytics.events(),consoleOutput:Raven.consoleLogs()},"true"==e.autoReport)try{var r=JSON.parse(JSON.stringify(t.formData||{})),s=["type","key","token","existingOutputPolicy","systemFonts"];Object.keys(r).forEach(function(e){s.includes(e)||delete r[e]}),t.formData=r}catch(e){}}return e.debugInfo=JSON.stringify(t,null,2),$.ajax({url:"https://www.sejda.com/contact",method:"POST",data:e})},e}(),a.on("show.bs.modal",function(){i.focus(),r.hide(),s.hide(),o.show();var e=Sejda.LocalStorage.getItem("contactForm.email");e&&$("#contact-email").val(e),setTimeout(function(){o.find("[name=suflet]").val("realitate")},2e3)}),$(document).on("showContactForm",function(e,t){t=t||{},t.message?i.val(t.message):i.val(""),a.modal()}),$(document).on("click",".bug-report-btn",function(e){return e.preventDefault(),$(document).trigger("showContactForm",{message:"I stumbled upon an error while using Sejda PDF Desktop"}),!1}),o.submit(function(e){e.preventDefault();var t=$("#contact-email").val();Sejda.LocalStorage.setItem("contactForm.email",t);var n=o.serializeJSON(),a=n.message.length>7,c=n.message.trim().split(" ").length>=2;if(!(n.message&&a&&c))return i.addClass("invalid").focus(),!1;i.removeClass("invalid");var u=$("#sendMessageBtn");return u.attr("disabled","disabled"),Sejda.Desktop.ContactForm.submit(n).always(function(){setTimeout(function(){u.removeAttr("disabled")},5e3)}).done(function(e){i.val(""),o.hide(),e=e||{},e.bugReportResponse?(s.find(".remote-response").html(Sejda.Utils.sanitizeHTMLAllowTags(e.bugReportResponse)),s.show()):r.show()}).fail(function(){alert("Something went wrong, your message could not be delivered.\nPlease try again or email us at hi@sejda.com")}),!1})});var loaded=0,pageScripts=$(".pageScripts").map(function(){return $(this).attr("data-src")});loadScripts(pageScripts),$(function(){$("#task-content").length>0&&Sejda.pageMenuActions.push({label:s_i18n("Start new"),id:"file-start-new",callback:function(){window.location.reload()}}),window.location.pathname.endsWith("open-with.ejs")&&Sejda.pageMenuActions.push({label:s_i18n("Duplicate original as")+"...",id:"file-save-as",callback:function(){window.sejdaSaveAsHandler()}},{label:s_i18n("Print")+"...",id:"file-print",callback:function(){window.print()}}),Sejda.AppWindow.setMenuPageActions(Sejda.pageMenuActions)});