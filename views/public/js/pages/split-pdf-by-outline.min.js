$(function(){$(document).on("filesSelected",function(e,a){var t=$("#pdfBookmarks");if(a.files.length>1){var n=$("[name=outputFilenamePattern]"),i=n.val();i.indexOf("[BASENAME]")==-1&&(i="[BASENAME]_"+i,n.val(i))}PdfFiles.getDocument(a.files[0],function(e){e.getOutline().then(function(e){function a(e){if(0==e.length)return 0;var t=_.map(e,function(e){return a(e.items)});return _.max(t)+1}function n(e,a,t){return t=t||1,t==a?e:_.flatten(_.map(e,function(e){return n(e.items,a,t+1)}))}function i(e,a,t){var n=$("<ol></ol>");return _.each(e,function(e){if(e.title.indexOf(t)>=0){var l=$('<li data-level="'+a+'"><span class="title">'+e.title+"<span></li>");if(e.items&&e.items.length>0){l.addClass("expandable"),l.prepend($('<i class="fal fa-caret-right"></i>'));var r=i(e.items,a+1,"");r.hide(),l.append(r),l.click(function(e){$(e.target).parents("li").attr("data-level")==""+a&&(l.hasClass("expanded")?(l.children(".fa-caret-down").addClass("fa-caret-right").removeClass("fa-caret-down"),l.children("ol").fadeOut(100),l.removeClass("expanded")):(l.children(".fa-caret-right").addClass("fa-caret-down").removeClass("fa-caret-right"),l.children("ol").fadeIn(100),l.addClass("expanded")))})}n.append(l)}}),n}function l(a){var t=n(e,a);o(t,a,"")}function r(e){var a=$("#bookmarksLevelSelector");a.empty();for(var t=1;t<=e;t++){var n=$('<label class="btn btn-default btn-xs"><input value="'+t+'" name="bookmarksLevel" type="radio">'+t+" </label>");n.click(function(){l(parseInt($(this).find("input").val()))}),a.append(n)}a.find("label").first().addClass("active").find("input").attr("checked","checked")}function o(e,a,n){t.empty().append(i(e,a,n))}if(console.log("Outline is",e),null!=e){o(e,1,"");var s=a(e);r(s),l(1)}else t.empty().append("No table of contents found"),$("#no-toc-warning").show(),$(".task-form [type=submit]").attr("disabled","disabled");$(".doc-loading").hide(),$("#bookmarksExpression").keyup(function(a){var t=$("#bookmarksExpression").val(),i=parseInt($("#bookmarksLevelSelector").find(".active input").val()),l=n(e,i);o(l,i,t)})})})})});