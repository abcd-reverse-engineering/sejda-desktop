$(function(){function a(){const a=o.val(),e=o.find("option[value='"+a+"']"),t=parseFloat(e.attr("data-w")),n=parseFloat(e.attr("data-h")),i=s.val(),d=parseFloat(r.val()),c=Sejda.Thumbs.getSize();$(".image-page").each(function(){var a=$(this),e=a.find("img"),o=parseInt(a.parents(".pdf-page-wrap").attr("data-rotation")||"0"),s=e.get(0).naturalWidth,r=e.get(0).naturalHeight;if(90===o||270===o){var g=s;s=r,r=g}var l=i;"auto"==l&&(l=s>r?"landscape":"portrait");var u=t,p=n,h=!1;isNaN(t)&&isNaN(n)&&(u=s,p=r,h=!0);var m=c,f=c*p/u;"landscape"!=l||h?a.css("height",f+"px").css("width",m+"px"):a.css("height",m+"px").css("width",f+"px");var v=d*m/u;isNaN(t)&&(v=72*d*m/s),e.css("border-width",v+"px"),a.siblings(".image-page-caption").css("width",a.css("width"))})}function e(){setTimeout(a,100)}function t(){var a=$(".image-page").find("img");return void 0==_.find(a,function(a){return 0===a.naturalWidth})}function n(){t()?a():setTimeout(n,100)}function i(a){return $(a.elm).attr("data-filename-raw").toLowerCase()}var o=$("#pageSize"),s=$("#pageOrientation"),r=$("#pageMargin");r.on("changed.bs.select",e),o.on("changed.bs.select",e),s.on("changed.bs.select",e),o.on("changed.bs.select",function(a,t){const n=o.val();if("custom"===n){const i=$("#customPageSizePrompt");i.on("hidden.bs.modal",function(){const a=parseFloat(i.find("[name=pageSizeWidth]").val()),t=parseFloat(i.find("[name=pageSizeHeight]").val());return a<=0||t<=0?(o.val("auto"),void o.selectpicker("refresh")):($("#pageSizeCustomOption").attr("data-w",a).attr("data-h",t).text("Custom size ("+a+" x "+t+")"),o.selectpicker("refresh"),void e())}),i.modal("show")}}),$(document).on("imagePagesRendered",function(){n()});var d=$("#image-canvas-list");$(document).on("imagePagesRendered",function(a){d.find(".pdf-page-wrap").addClass("grabbable"),d.sortable(),d.disableSelection()}),$(document).on("thumbSizeChanged",a),$(document).on("pageRotated",a);var c=$("#tools-menu"),g=$("#globalBtns");g.detach().appendTo(c).show();var l=0;$(document).on("imagePagesRendered",function(){var a=!0;0===l?l=Date.now():Date.now()-l>4e3&&(a=!1),a&&tinysort("#image-canvas-list>li",{order:"asc",sortFunction:function(a,e){return naturalSort(i(a),i(e))}})})});